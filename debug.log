2024-10-09T18:19:51.771305+0300  INFO  Бот запущен
2024-10-11T00:41:37.763615+0300  INFO  Бот запущен
2024-10-11T00:41:37.763615+0300  INFO  Бот запущен
2024-10-11T00:44:13.789125+0300  INFO  Бот запущен
2024-10-11T00:44:13.789125+0300  INFO  Бот запущен
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:46:28.668346+0300  INFO  Бот запущен
2024-10-11T00:46:28.668346+0300  INFO  Бот запущен
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:54.687307+0300  INFO  Бот запущен
2024-10-11T00:47:54.687307+0300  INFO  Бот запущен
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T13:41:47.826766+0300  INFO  Бот запущен
2024-10-11T13:41:47.826766+0300  INFO  Бот запущен
2024-10-11T13:42:39.137180+0300  INFO  Бот запущен
2024-10-11T13:42:39.137180+0300  INFO  Бот запущен
2024-10-11T13:44:47.636492+0300  INFO  Бот запущен
2024-10-11T13:44:47.636492+0300  INFO  Бот запущен
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:51:33.351399+0300  INFO  Бот запущен
2024-10-11T13:51:33.351399+0300  INFO  Бот запущен
2024-10-11T13:56:18.498395+0300  INFO  Бот запущен
2024-10-11T13:56:18.498395+0300  INFO  Бот запущен
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T14:01:27.878060+0300  INFO  Бот запущен
2024-10-11T14:01:27.878060+0300  INFO  Бот запущен
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:35.670018+0300  INFO  Бот запущен
2024-10-11T14:04:35.670018+0300  INFO  Бот запущен
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:47.705219+0300  INFO  Бот запущен
2024-10-11T14:10:47.705219+0300  INFO  Бот запущен
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:13:11.896596+0300  INFO  Бот запущен
2024-10-11T14:13:11.896596+0300  INFO  Бот запущен
2024-10-11T14:13:25.477238+0300  INFO  Бот запущен
2024-10-11T14:13:25.477238+0300  INFO  Бот запущен
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:15:37.958500+0300  INFO  Бот запущен
2024-10-11T14:15:37.958500+0300  INFO  Бот запущен
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:16:21.049120+0300  INFO  Бот запущен
2024-10-11T14:16:21.049120+0300  INFO  Бот запущен
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:50.604441+0300  INFO  Бот запущен
2024-10-11T14:17:50.604441+0300  INFO  Бот запущен
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:21:48.915453+0300  INFO  Бот запущен
2024-10-11T14:21:48.915453+0300  INFO  Бот запущен
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:02.359407+0300  INFO  Бот запущен
2024-10-11T14:24:02.359407+0300  INFO  Бот запущен
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:25:56.031464+0300  INFO  Бот запущен
2024-10-11T14:25:56.031464+0300  INFO  Бот запущен
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:47.347178+0300  INFO  Бот запущен
2024-10-11T14:26:47.347178+0300  INFO  Бот запущен
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:37:10.314063+0300  INFO  Бот запущен
2024-10-11T14:37:10.314063+0300  INFO  Бот запущен
2024-10-11T14:37:10.329787+0300  ERROR  An error has been caught in function '_run', process 'MainProcess' (45949), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 29, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1029b23e0>
    │       └ <function run at 0x10301fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107bbe340>
           │      └ <function Runner.run at 0x10309d4e0>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103092fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103092f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10309cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102fda020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

> File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 18, in main
    bot = Bot(token=os.getenv("BOT_TOKEN"),
          │         │  └ <function getenv at 0x10290a660>
          │         └ <module 'os' (frozen)>
          └ <class 'aiogram.client.bot.Bot'>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/client/bot.py", line 304, in __init__
    raise TypeError(

TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN_V2: 'MarkdownV2'>)` argument instead.
2024-10-11T14:37:10.329787+0300  ERROR  An error has been caught in function '_run', process 'MainProcess' (45949), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 29, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1029b23e0>
    │       └ <function run at 0x10301fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107bbe340>
           │      └ <function Runner.run at 0x10309d4e0>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103092fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103092f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10309cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102fda020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

> File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 18, in main
    bot = Bot(token=os.getenv("BOT_TOKEN"),
          │         │  └ <function getenv at 0x10290a660>
          │         └ <module 'os' (frozen)>
          └ <class 'aiogram.client.bot.Bot'>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/client/bot.py", line 304, in __init__
    raise TypeError(

TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN_V2: 'MarkdownV2'>)` argument instead.
2024-10-11T14:37:10.329787+0300  ERROR  An error has been caught in function '_run', process 'MainProcess' (45949), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 29, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1029b23e0>
    │       └ <function run at 0x10301fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107bbe340>
           │      └ <function Runner.run at 0x10309d4e0>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103092fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103092f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10309cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102fda020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

> File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 18, in main
    bot = Bot(token=os.getenv("BOT_TOKEN"),
          │         │  └ <function getenv at 0x10290a660>
          │         └ <module 'os' (frozen)>
          └ <class 'aiogram.client.bot.Bot'>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/client/bot.py", line 304, in __init__
    raise TypeError(

TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN_V2: 'MarkdownV2'>)` argument instead.
2024-10-11T14:41:53.049470+0300  INFO  Бот запущен
2024-10-11T14:41:53.049470+0300  INFO  Бот запущен
2024-10-11T14:41:56.379753+0300  ERROR  Ошибка при вводе команды /start: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-11T14:41:56.379753+0300  ERROR  Ошибка при вводе команды /start: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-11T14:41:56.379753+0300  ERROR  Ошибка при вводе команды /start: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-11T14:48:07.915750+0300  INFO  Бот запущен
2024-10-11T14:48:07.915750+0300  INFO  Бот запущен
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T15:23:00.633860+0300  INFO  Бот запущен
2024-10-11T15:23:00.633860+0300  INFO  Бот запущен
2024-10-11T15:23:54.017391+0300  INFO  Бот запущен
2024-10-11T15:23:54.017391+0300  INFO  Бот запущен
2024-10-11T15:24:11.126529+0300  INFO  Бот запущен
2024-10-11T15:24:11.126529+0300  INFO  Бот запущен
2024-10-11T15:26:52.528612+0300  INFO  Бот запущен
2024-10-11T15:26:52.528612+0300  INFO  Бот запущен
2024-10-11T15:27:33.026702+0300  INFO  Бот запущен
2024-10-11T15:27:33.026702+0300  INFO  Бот запущен
2024-10-11T15:27:56.228155+0300  INFO  Бот запущен
2024-10-11T15:27:56.228155+0300  INFO  Бот запущен
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:29:55.757134+0300  INFO  Бот запущен
2024-10-11T15:29:55.757134+0300  INFO  Бот запущен
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:34:34.345280+0300  INFO  Бот запущен
2024-10-11T15:34:34.345280+0300  INFO  Бот запущен
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:40.555603+0300  INFO  Бот запущен
2024-10-11T15:39:40.555603+0300  INFO  Бот запущен
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:40:52.109798+0300  INFO  Бот запущен
2024-10-11T15:40:52.109798+0300  INFO  Бот запущен
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:45:33.575733+0300  INFO  Бот запущен
2024-10-11T15:45:33.575733+0300  INFO  Бот запущен
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:55:49.527525+0300  INFO  Бот запущен
2024-10-11T15:55:49.527525+0300  INFO  Бот запущен
2024-10-11T15:57:43.317451+0300  INFO  Бот запущен
2024-10-11T15:57:43.317451+0300  INFO  Бот запущен
2024-10-12T01:24:33.651258+0300  INFO  Бот запущен
2024-10-12T01:24:33.651258+0300  INFO  Бот запущен
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:26:38.245319+0300  INFO  Бот запущен
2024-10-12T04:26:38.245319+0300  INFO  Бот запущен
2024-10-12T04:27:29.923567+0300  INFO  Бот запущен
2024-10-12T04:27:29.923567+0300  INFO  Бот запущен
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:40:41.419433+0300  INFO  Бот запущен
2024-10-12T04:40:41.419433+0300  INFO  Бот запущен
2024-10-12T04:42:47.763040+0300  INFO  Бот запущен
2024-10-12T04:42:47.763040+0300  INFO  Бот запущен
2024-10-12T04:43:15.395828+0300  INFO  Бот запущен
2024-10-12T04:43:15.395828+0300  INFO  Бот запущен
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:46:20.578655+0300  INFO  Бот запущен
2024-10-12T04:46:20.578655+0300  INFO  Бот запущен
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:42.460478+0300  INFO  Бот запущен
2024-10-12T04:54:42.460478+0300  INFO  Бот запущен
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:36.177883+0300  INFO  Бот запущен
2024-10-12T05:04:36.177883+0300  INFO  Бот запущен
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:06:31.295600+0300  INFO  Бот запущен
2024-10-12T05:06:31.295600+0300  INFO  Бот запущен
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:07:09.053254+0300  INFO  Бот запущен
2024-10-12T05:07:09.053254+0300  INFO  Бот запущен
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:36:44.859734+0300  INFO  Бот запущен
2024-10-12T23:36:44.859734+0300  INFO  Бот запущен
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:42:46.001754+0300  INFO  Бот запущен
2024-10-12T23:42:46.001754+0300  INFO  Бот запущен
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:27.509616+0300  INFO  Бот запущен
2024-10-12T23:43:27.509616+0300  INFO  Бот запущен
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:09:16.798199+0300  INFO  Бот запущен
2024-10-13T00:09:16.798199+0300  INFO  Бот запущен
2024-10-13T00:11:05.195076+0300  INFO  Бот запущен
2024-10-13T00:11:05.195076+0300  INFO  Бот запущен
2024-10-13T00:12:29.039578+0300  INFO  Бот запущен
2024-10-13T00:12:29.039578+0300  INFO  Бот запущен
2024-10-13T00:14:03.325333+0300  INFO  Бот запущен
2024-10-13T00:14:03.325333+0300  INFO  Бот запущен
2024-10-13T00:14:23.898268+0300  INFO  Бот запущен
2024-10-13T00:14:23.898268+0300  INFO  Бот запущен
2024-10-13T00:17:07.840941+0300  INFO  Бот запущен
2024-10-13T00:17:07.840941+0300  INFO  Бот запущен
2024-10-13T00:17:47.631680+0300  INFO  Бот запущен
2024-10-13T00:17:47.631680+0300  INFO  Бот запущен
2024-10-13T00:19:32.486472+0300  INFO  Бот запущен
2024-10-13T00:19:32.486472+0300  INFO  Бот запущен
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:22:00.929352+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51406), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 116, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1096f4720>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:22:00.929352+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51406), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 116, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1096f4720>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:31:38.244624+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51594), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 119, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1077cc680>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:31:38.244624+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51594), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 119, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1077cc680>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:31:59.468931+0300  INFO  Бот запущен
2024-10-13T00:31:59.468931+0300  INFO  Бот запущен
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:33:40.184619+0300  INFO  Бот запущен
2024-10-13T00:33:40.184619+0300  INFO  Бот запущен
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:35:03.339157+0300  INFO  Бот запущен
2024-10-13T00:36:11.118014+0300  INFO  Бот запущен
2024-10-13T00:39:44.791792+0300  INFO  Бот запущен
2024-10-13T00:40:04.258506+0300  INFO  Бот запущен
2024-10-13T00:47:31.481478+0300  INFO  Бот запущен
2024-10-13T00:47:47.375331+0300  INFO  Бот запущен
2024-10-13T00:48:26.206485+0300  INFO  Бот запущен
2024-10-13T00:50:22.775912+0300  INFO  Бот запущен
2024-10-13T00:51:31.360380+0300  INFO  Бот запущен
2024-10-13T00:52:41.535607+0300  INFO  Бот запущен
2024-10-13T00:53:18.685267+0300  INFO  Бот запущен
2024-10-13T00:53:35.082218+0300  INFO  Бот запущен
2024-10-13T00:54:17.287265+0300  INFO  Бот запущен
2024-10-13T00:54:45.431489+0300  INFO  Бот запущен
2024-10-13T00:55:58.069650+0300  INFO  Бот запущен
2024-10-13T00:56:47.504673+0300  INFO  Бот запущен
2024-10-13T00:59:17.386010+0300  INFO  Бот запущен
2024-10-13T01:00:30.724682+0300  INFO  Бот запущен
2024-10-13T01:00:56.033789+0300  INFO  Бот запущен
2024-10-13T01:01:05.125825+0300  INFO  Бот запущен
2024-10-13T01:01:15.118325+0300  INFO  Бот запущен
2024-10-13T01:01:26.324781+0300  INFO  Бот запущен
2024-10-13T01:01:38.568866+0300  INFO  Бот запущен
2024-10-13T01:02:00.110230+0300  INFO  Бот запущен
2024-10-13T01:02:19.140168+0300  INFO  Бот запущен
2024-10-13T01:34:50.717975+0300  INFO  Бот запущен
2024-10-13T01:34:50.717975+0300  INFO  Бот запущен
2024-10-13T01:35:14.858539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:35:14.858539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:35:14.858539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:35:14.858539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:35:14.858539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:35:14.952272+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse inline keyboard button: Text buttons are unallowed in the inline keyboard
2024-10-13T01:35:14.952272+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse inline keyboard button: Text buttons are unallowed in the inline keyboard
2024-10-13T01:35:14.952272+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse inline keyboard button: Text buttons are unallowed in the inline keyboard
2024-10-13T01:35:14.952272+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse inline keyboard button: Text buttons are unallowed in the inline keyboard
2024-10-13T01:35:14.952272+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse inline keyboard button: Text buttons are unallowed in the inline keyboard
2024-10-13T01:37:18.786541+0300  INFO  Бот запущен
2024-10-13T01:37:18.786541+0300  INFO  Бот запущен
2024-10-13T01:37:22.835371+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:37:22.835371+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:37:22.835371+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:37:22.835371+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:37:22.835371+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T01:37:23.225337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T01:37:23.225337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T01:37:23.225337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T01:37:23.225337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T01:37:23.225337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T02:08:32.961546+0300  INFO  Бот запущен
2024-10-13T02:08:32.961546+0300  INFO  Бот запущен
2024-10-13T02:08:41.159296+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:08:41.159296+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:08:41.159296+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:08:41.159296+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:08:41.159296+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:08:41.162108+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=Ellipsis, input_type=ellipsis]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:08:41.162108+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=Ellipsis, input_type=ellipsis]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:08:41.162108+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=Ellipsis, input_type=ellipsis]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:08:41.162108+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=Ellipsis, input_type=ellipsis]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:08:41.162108+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=Ellipsis, input_type=ellipsis]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:09:10.210639+0300  INFO  Бот запущен
2024-10-13T02:09:10.210639+0300  INFO  Бот запущен
2024-10-13T02:10:10.841091+0300  INFO  Бот запущен
2024-10-13T02:10:10.841091+0300  INFO  Бот запущен
2024-10-13T02:10:17.423648+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:17.423648+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:17.423648+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:17.423648+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:17.423648+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:17.426767+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=<coroutine object regener...e_answer at 0x114349a80>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:10:17.426767+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=<coroutine object regener...e_answer at 0x114349a80>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:10:17.426767+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=<coroutine object regener...e_answer at 0x114349a80>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:10:17.426767+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=<coroutine object regener...e_answer at 0x114349a80>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:10:17.426767+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=<coroutine object regener...e_answer at 0x114349a80>, input_type=coroutine]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:10:35.618816+0300  INFO  Бот запущен
2024-10-13T02:10:35.618816+0300  INFO  Бот запущен
2024-10-13T02:10:41.069152+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:41.069152+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:41.069152+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:41.069152+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:41.069152+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:10:41.074141+0300  ERROR  Ошибка при отправке сообщения: (1054, "Unknown column 'content' in 'field list'")
2024-10-13T02:10:41.074141+0300  ERROR  Ошибка при отправке сообщения: (1054, "Unknown column 'content' in 'field list'")
2024-10-13T02:10:41.074141+0300  ERROR  Ошибка при отправке сообщения: (1054, "Unknown column 'content' in 'field list'")
2024-10-13T02:10:41.074141+0300  ERROR  Ошибка при отправке сообщения: (1054, "Unknown column 'content' in 'field list'")
2024-10-13T02:10:41.074141+0300  ERROR  Ошибка при отправке сообщения: (1054, "Unknown column 'content' in 'field list'")
2024-10-13T02:11:58.095589+0300  INFO  Бот запущен
2024-10-13T02:11:58.095589+0300  INFO  Бот запущен
2024-10-13T02:12:03.611553+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:12:03.611553+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:12:03.611553+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:12:03.611553+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:12:03.611553+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T02:12:03.618941+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=True, input_type=bool]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:12:03.618941+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=True, input_type=bool]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:12:03.618941+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=True, input_type=bool]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:12:03.618941+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=True, input_type=bool]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:12:03.618941+0300  ERROR  Ошибка при отправке сообщения: 1 validation error for InlineKeyboardButton
callback_data
  Input should be a valid string [type=string_type, input_value=True, input_type=bool]
    For further information visit https://errors.pydantic.dev/2.9/v/string_type
2024-10-13T02:25:49.941206+0300  INFO  Бот запущен
2024-10-13T02:25:49.941206+0300  INFO  Бот запущен
2024-10-13T02:26:04.628647+0300  INFO  Бот запущен
2024-10-13T02:26:04.628647+0300  INFO  Бот запущен
2024-10-13T02:26:32.352139+0300  INFO  Бот запущен
2024-10-13T02:26:32.352139+0300  INFO  Бот запущен
2024-10-13T02:28:41.797741+0300  INFO  Бот запущен
2024-10-13T02:28:41.797741+0300  INFO  Бот запущен
2024-10-13T02:29:05.730004+0300  INFO  Бот запущен
2024-10-13T02:29:05.730004+0300  INFO  Бот запущен
2024-10-13T02:29:37.810872+0300  INFO  Бот запущен
2024-10-13T02:29:37.810872+0300  INFO  Бот запущен
2024-10-13T02:29:55.586542+0300  INFO  Бот запущен
2024-10-13T02:29:55.586542+0300  INFO  Бот запущен
2024-10-13T02:32:38.997712+0300  INFO  Бот запущен
2024-10-13T02:32:38.997712+0300  INFO  Бот запущен
2024-10-13T21:54:30.412870+0300  INFO  Бот запущен
2024-10-13T21:54:30.412870+0300  INFO  Бот запущен
2024-10-13T21:54:38.850492+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:54:38.850492+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:54:38.850492+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:54:38.850492+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:54:38.850492+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:54:38.852064+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59611), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Как я могу помочь тебе сегодня?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x104a73560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x104a942c0>
          └ <aiomysql.cursors.Cursor object at 0x105de06b0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005be3e0>
    │       └ <function run at 0x100c27c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1057da540>
           │      └ <function Runner.run at 0x100ca94e0>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c9efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c9ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100ca8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100be6020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,)}
                     │    │           │    └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105829310>
                     │    └ <function Dispatcher.feed_update at 0x10493fc40>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a480>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10582a5a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10582a660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x105b64720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x105b67420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105829250'>>, Update(update_id=257714969, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10493f240>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b674c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058292b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10493f240>
                     └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b67560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10493e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x105b66840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x105816700>, Message(message_id=2658, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x105b74500>, 'bot': <aiogram.client.bot.Bot object at 0x105829310>}
                 │     └ (Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x105816660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x1053f7740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:54:38.852064+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59611), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Как я могу помочь тебе сегодня?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x104a73560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x104a942c0>
          └ <aiomysql.cursors.Cursor object at 0x105de06b0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005be3e0>
    │       └ <function run at 0x100c27c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1057da540>
           │      └ <function Runner.run at 0x100ca94e0>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c9efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c9ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100ca8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100be6020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,)}
                     │    │           │    └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105829310>
                     │    └ <function Dispatcher.feed_update at 0x10493fc40>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a480>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10582a5a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10582a660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x105b64720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x105b67420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105829250'>>, Update(update_id=257714969, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10493f240>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b674c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058292b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10493f240>
                     └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b67560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10493e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x105b66840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x105816700>, Message(message_id=2658, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x105b74500>, 'bot': <aiogram.client.bot.Bot object at 0x105829310>}
                 │     └ (Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x105816660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x1053f7740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:54:38.852064+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59611), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Как я могу помочь тебе сегодня?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x104a73560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x104a942c0>
          └ <aiomysql.cursors.Cursor object at 0x105de06b0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005be3e0>
    │       └ <function run at 0x100c27c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1057da540>
           │      └ <function Runner.run at 0x100ca94e0>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c9efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c9ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100ca8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100be6020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,)}
                     │    │           │    └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105829310>
                     │    └ <function Dispatcher.feed_update at 0x10493fc40>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a480>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10582a5a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10582a660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x105b64720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x105b67420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105829250'>>, Update(update_id=257714969, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10493f240>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b674c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058292b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10493f240>
                     └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b67560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10493e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x105b66840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x105816700>, Message(message_id=2658, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x105b74500>, 'bot': <aiogram.client.bot.Bot object at 0x105829310>}
                 │     └ (Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x105816660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x1053f7740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:54:38.852064+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59611), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Как я могу помочь тебе сегодня?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x104a73560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x104a942c0>
          └ <aiomysql.cursors.Cursor object at 0x105de06b0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005be3e0>
    │       └ <function run at 0x100c27c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1057da540>
           │      └ <function Runner.run at 0x100ca94e0>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c9efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c9ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100ca8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100be6020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,)}
                     │    │           │    └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105829310>
                     │    └ <function Dispatcher.feed_update at 0x10493fc40>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a480>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10582a5a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10582a660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x105b64720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x105b67420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105829250'>>, Update(update_id=257714969, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10493f240>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b674c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058292b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10493f240>
                     └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b67560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10493e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x105b66840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x105816700>, Message(message_id=2658, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x105b74500>, 'bot': <aiogram.client.bot.Bot object at 0x105829310>}
                 │     └ (Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x105816660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x1053f7740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:54:38.852064+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59611), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Как я могу помочь тебе сегодня?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x104a73560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x104a942c0>
          └ <aiomysql.cursors.Cursor object at 0x105de06b0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005be3e0>
    │       └ <function run at 0x100c27c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1057da540>
           │      └ <function Runner.run at 0x100ca94e0>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c9efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105232ea0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c9ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100ca8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100be6020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,)}
                     │    │           │    └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105829310>
                     │    └ <function Dispatcher.feed_update at 0x10493fc40>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a480>
                     └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10582a5a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10582a660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x105b64720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714969, message=Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x105b67420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105829250'>>, Update(update_id=257714969, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10493f240>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b674c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058292b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Dispatcher '0x105829250'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10493f240>
                     └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x105b67560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10493e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10493f2e0>
                 └ <Router '0x1049d2b40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10493e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1049d2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105829250'>, 'bots': (<aiogram.client.bot.Bot object at 0x105829310>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x105b66840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x105816700>, Message(message_id=2658, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x105b74500>, 'bot': <aiogram.client.bot.Bot object at 0x105829310>}
                 │     └ (Message(message_id=2658, date=datetime.datetime(2024, 10, 13, 18, 54, 36, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x105816660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x1053f7740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:54:38.902350+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:54:38.902350+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:54:38.902350+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:54:38.902350+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:54:38.902350+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:56:13.694716+0300  INFO  Бот запущен
2024-10-13T21:56:13.694716+0300  INFO  Бот запущен
2024-10-13T21:56:22.779317+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:56:22.779317+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:56:22.779317+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:56:22.779317+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:56:22.779317+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Cursor.executemany() takes 3 positional arguments but 4 were given
2024-10-13T21:56:22.780587+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59677), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108cdb560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x108cfc2c0>
          └ <aiomysql.cursors.Cursor object at 0x1099303e0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x108c4cea0>
    │       └ <function run at 0x104e8fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109a42540>
           │      └ <function Runner.run at 0x104f114e0>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f06fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f06f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f10d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e4e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,)}
                     │    │           │    └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109a90e00>
                     │    └ <function Dispatcher.feed_update at 0x108ba7c40>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a922d0>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109a923f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109a924b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109dcc720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x109dcf420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109a91130'>>, Update(update_id=257714972, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108ba7240>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a90e60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108ba7240>
                     └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108ba68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x109dce840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109a7a700>, Message(message_id=2664, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x109a90e00>, 'state': <aiogram.fsm.context.FSMContext object at 0x109ef77a0>}
                 │     └ (Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109a7a660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x10965f740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:56:22.780587+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59677), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108cdb560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x108cfc2c0>
          └ <aiomysql.cursors.Cursor object at 0x1099303e0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x108c4cea0>
    │       └ <function run at 0x104e8fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109a42540>
           │      └ <function Runner.run at 0x104f114e0>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f06fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f06f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f10d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e4e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,)}
                     │    │           │    └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109a90e00>
                     │    └ <function Dispatcher.feed_update at 0x108ba7c40>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a922d0>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109a923f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109a924b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109dcc720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x109dcf420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109a91130'>>, Update(update_id=257714972, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108ba7240>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a90e60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108ba7240>
                     └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108ba68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x109dce840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109a7a700>, Message(message_id=2664, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x109a90e00>, 'state': <aiogram.fsm.context.FSMContext object at 0x109ef77a0>}
                 │     └ (Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109a7a660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x10965f740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:56:22.780587+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59677), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108cdb560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x108cfc2c0>
          └ <aiomysql.cursors.Cursor object at 0x1099303e0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x108c4cea0>
    │       └ <function run at 0x104e8fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109a42540>
           │      └ <function Runner.run at 0x104f114e0>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f06fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f06f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f10d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e4e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,)}
                     │    │           │    └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109a90e00>
                     │    └ <function Dispatcher.feed_update at 0x108ba7c40>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a922d0>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109a923f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109a924b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109dcc720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x109dcf420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109a91130'>>, Update(update_id=257714972, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108ba7240>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a90e60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108ba7240>
                     └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108ba68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x109dce840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109a7a700>, Message(message_id=2664, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x109a90e00>, 'state': <aiogram.fsm.context.FSMContext object at 0x109ef77a0>}
                 │     └ (Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109a7a660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x10965f740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:56:22.780587+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59677), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108cdb560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x108cfc2c0>
          └ <aiomysql.cursors.Cursor object at 0x1099303e0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x108c4cea0>
    │       └ <function run at 0x104e8fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109a42540>
           │      └ <function Runner.run at 0x104f114e0>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f06fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f06f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f10d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e4e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,)}
                     │    │           │    └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109a90e00>
                     │    └ <function Dispatcher.feed_update at 0x108ba7c40>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a922d0>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109a923f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109a924b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109dcc720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x109dcf420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109a91130'>>, Update(update_id=257714972, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108ba7240>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a90e60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108ba7240>
                     └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108ba68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x109dce840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109a7a700>, Message(message_id=2664, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x109a90e00>, 'state': <aiogram.fsm.context.FSMContext object at 0x109ef77a0>}
                 │     └ (Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109a7a660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x10965f740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:56:22.780587+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (59677), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:], model_gpt)
          │                    │            │                     └ 'gpt-4o-mini'
          │                    │            └ [{'role': 'user', 'content': 'Привет!'}, {'role': 'assistant', 'content': 'Привет! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108cdb560>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 84, in save_message_history
    await cur.executemany("""
          │   └ <function Cursor.executemany at 0x108cfc2c0>
          └ <aiomysql.cursors.Cursor object at 0x1099303e0>

TypeError: Cursor.executemany() takes 3 positional arguments but 4 were given


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x108c4cea0>
    │       └ <function run at 0x104e8fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109a42540>
           │      └ <function Runner.run at 0x104f114e0>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f06fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1094b7110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f06f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f10d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e4e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,)}
                     │    │           │    └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109a90e00>
                     │    └ <function Dispatcher.feed_update at 0x108ba7c40>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a922d0>
                     └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109a923f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109a924b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109dcc720>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714972, message=Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x109dcf420>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109a91130'>>, Update(update_id=257714972, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108ba7240>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109a90e60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Dispatcher '0x109a91130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108ba7240>
                     └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109dcf560>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108ba67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108ba72e0>
                 └ <Router '0x1092f6900'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108ba68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108c3e9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109a91130'>, 'bots': (<aiogram.client.bot.Bot object at 0x109a90e00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x109dce840>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109a7a700>, Message(message_id=2664, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x109a90e00>, 'state': <aiogram.fsm.context.FSMContext object at 0x109ef77a0>}
                 │     └ (Message(message_id=2664, date=datetime.datetime(2024, 10, 13, 18, 56, 20, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109a7a660>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 150, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Привет!'
                          └ <function gpt at 0x10965f740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-13T21:56:22.830027+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:56:22.830027+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:56:22.830027+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:56:22.830027+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T21:56:22.830027+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-13T22:05:11.625150+0300  INFO  Бот запущен
2024-10-13T22:05:11.625150+0300  INFO  Бот запущен
2024-10-13T22:05:20.522233+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:05:20.522233+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:05:20.522233+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:05:20.522233+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:05:20.522233+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:05:23.112344+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:05:23.112344+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:05:23.112344+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:05:23.112344+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:05:23.112344+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.841861+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:07:24.980839+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:50:50.490880+0300  INFO  Бот запущен
2024-10-13T22:50:50.490880+0300  INFO  Бот запущен
2024-10-13T22:51:07.443691+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:51:07.443691+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:51:07.443691+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:51:07.443691+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:51:07.443691+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:51:07.802644+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:51:07.802644+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:51:07.802644+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:51:07.802644+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:51:07.802644+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:54:21.590993+0300  INFO  Бот запущен
2024-10-13T22:54:21.590993+0300  INFO  Бот запущен
2024-10-13T22:54:28.763432+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:54:28.763432+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:54:28.763432+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:54:28.763432+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:54:28.763432+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T22:54:29.136590+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:54:29.136590+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:54:29.136590+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:54:29.136590+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T22:54:29.136590+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:00:19.358807+0300  INFO  Бот запущен
2024-10-13T23:00:19.358807+0300  INFO  Бот запущен
2024-10-13T23:00:28.999899+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:00:28.999899+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:00:28.999899+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:00:28.999899+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:00:28.999899+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:00:29.389455+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:00:29.389455+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:00:29.389455+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:00:29.389455+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:00:29.389455+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:04:38.406735+0300  INFO  Бот запущен
2024-10-13T23:04:38.406735+0300  INFO  Бот запущен
2024-10-13T23:06:16.904246+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:06:16.904246+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:06:16.904246+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:06:16.904246+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:06:16.904246+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:06:17.775316+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:06:17.775316+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:06:17.775316+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:06:17.775316+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:06:17.775316+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:09:50.463861+0300  INFO  Бот запущен
2024-10-13T23:09:50.463861+0300  INFO  Бот запущен
2024-10-13T23:10:01.319093+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:01.319093+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:01.319093+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:01.319093+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:01.319093+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:01.690869+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:01.690869+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:01.690869+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:01.690869+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:01.690869+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:33.064356+0300  INFO  Бот запущен
2024-10-13T23:10:33.064356+0300  INFO  Бот запущен
2024-10-13T23:10:40.293546+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:40.293546+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:40.293546+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:40.293546+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:40.293546+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:10:40.671243+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:40.671243+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:40.671243+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:40.671243+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:10:40.671243+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.423894+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:11:01.725176+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:12:45.628171+0300  INFO  Бот запущен
2024-10-13T23:12:45.628171+0300  INFO  Бот запущен
2024-10-13T23:12:54.581532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:12:54.581532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:12:54.581532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:12:54.581532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:12:54.581532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:12:55.116079+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:12:55.116079+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:12:55.116079+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:12:55.116079+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:12:55.116079+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:13:16.159206+0300  INFO  Бот запущен
2024-10-13T23:13:16.159206+0300  INFO  Бот запущен
2024-10-13T23:13:46.730731+0300  INFO  Бот запущен
2024-10-13T23:13:46.730731+0300  INFO  Бот запущен
2024-10-13T23:13:57.458074+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:13:57.458074+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:13:57.458074+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:13:57.458074+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:13:57.458074+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:13:57.837107+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:13:57.837107+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:13:57.837107+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:13:57.837107+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:13:57.837107+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:14:49.263604+0300  INFO  Бот запущен
2024-10-13T23:14:49.263604+0300  INFO  Бот запущен
2024-10-13T23:15:02.892400+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:02.892400+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:02.892400+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:02.892400+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:02.892400+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:03.336493+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:03.336493+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:03.336493+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:03.336493+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:03.336493+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.620217+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:15:16.783889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:17:34.828203+0300  INFO  Бот запущен
2024-10-13T23:17:34.828203+0300  INFO  Бот запущен
2024-10-13T23:17:47.420747+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:17:47.420747+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:17:47.420747+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:17:47.420747+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:17:47.420747+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:17:47.761916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:17:47.761916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:17:47.761916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:17:47.761916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:17:47.761916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.397528+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:17:50.398293+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60936), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1028aa3e0>
    │       └ <function run at 0x102f13c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107ac6640>
           │      └ <function Runner.run at 0x102f954e0>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102f8afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c88f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102f8af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102f94d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ed2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,)}
                     │    │           │    └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107b15070>
                     │    └ <function Dispatcher.feed_update at 0x106c2bc40>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b166f0>
                     └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107b16810>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107b168d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10858f4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715023, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10858f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107b15370'>>, Update(update_id=257715023, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106c2b240>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107b15940>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Dispatcher '0x107b15370'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106c2b240>
                     └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10858f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106c2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106c2b2e0>
                 └ <Router '0x1074573b0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106c2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107aeea80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107b15370'>, 'bots': (<aiogram.client.bot.Bot object at 0x107b15070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822216366969', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10858f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107b02200>, CallbackQuery(id='3684244822216366969', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state)
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x107f83a70>
          │                  └ 'Привет! Меня зовут Саша! А тебя?'
          └ <function process_generation at 0x107b025c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша! А тебя?', <aiogram.fsm.context.FSMContext object at 0x107f83a70>)
                 └ <function process_generation at 0x107b02700>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-13T23:19:06.607584+0300  INFO  Бот запущен
2024-10-13T23:19:06.607584+0300  INFO  Бот запущен
2024-10-13T23:19:15.612844+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:19:15.612844+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:19:15.612844+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:19:15.612844+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:19:15.612844+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:19:16.066776+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:19:16.066776+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:19:16.066776+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:19:16.066776+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:19:16.066776+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.652879+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:19:17.653769+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (60978), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1009ea3e0>
    │       └ <function run at 0x101053c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105c02640>
           │      └ <function Runner.run at 0x1010d54e0>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010cafc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1009088f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010caf20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101012020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,)}
                     │    │           │    └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105c55010>
                     │    └ <function Dispatcher.feed_update at 0x104d6bc40>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c56480>
                     └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105c565a0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105c56660>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10898f740>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715027, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10898f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x105b20b00'>>, Update(update_id=257715027, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104d6b240>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c55700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Dispatcher '0x105b20b00'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104d6b240>
                     └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10898f880>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x104d6a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x104d6b2e0>
                 └ <Router '0x104dfacc0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x104d6a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105c2e900>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x105b20b00'>, 'bots': (<aiogram.client.bot.Bot object at 0x105c55010>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244822446543009', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10898f9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x105c42200>, CallbackQuery(id='3684244822446543009', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(user_message, state, bot)
          │                  │             │      └ <aiogram.client.bot.Bot object at 0x105c55010>
          │                  │             └ <aiogram.fsm.context.FSMContext object at 0x106527950>
          │                  └ 'Привет! Меня зовут Саша'
          └ <function process_generation at 0x105c425c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Привет! Меня зовут Саша', <aiogram.fsm.context.FSMContext object at 0x106527950>, <aiogram.client.bot.Bot object at 0x105c5...
                 └ <function process_generation at 0x105c42700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 123, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Привет! Меня зовут Саша'
          │   └ <function Bot.send_chat_action at 0x104d004a0>
          └ <aiogram.client.bot.Bot object at 0x105c55010>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:22:53.561968+0300  INFO  Бот запущен
2024-10-13T23:22:53.561968+0300  INFO  Бот запущен
2024-10-13T23:24:19.225296+0300  INFO  Бот запущен
2024-10-13T23:24:19.225296+0300  INFO  Бот запущен
2024-10-13T23:25:01.478342+0300  INFO  Бот запущен
2024-10-13T23:25:01.478342+0300  INFO  Бот запущен
2024-10-13T23:26:18.793703+0300  INFO  Бот запущен
2024-10-13T23:26:18.793703+0300  INFO  Бот запущен
2024-10-13T23:26:26.924939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:26:26.924939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:26:26.924939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:26:26.924939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:26:26.924939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:26:27.280459+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:26:27.280459+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:26:27.280459+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:26:27.280459+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:26:27.280459+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:28:05.258146+0300  INFO  Бот запущен
2024-10-13T23:28:05.258146+0300  INFO  Бот запущен
2024-10-13T23:43:00.713134+0300  INFO  Бот запущен
2024-10-13T23:43:00.713134+0300  INFO  Бот запущен
2024-10-13T23:43:29.862898+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:43:29.862898+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:43:29.862898+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:43:29.862898+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:43:29.862898+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:43:30.498332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:43:30.498332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:43:30.498332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:43:30.498332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:43:30.498332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.165675+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:43:34.167102+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62057), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104e8a3e0>
    │       └ <function run at 0x1054f3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a0a6640>
           │      └ <function Runner.run at 0x1055754e0>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10556afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f52f90>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10556af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105574d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054b2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,)}
                     │    │           │    └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
                     │    └ <function Dispatcher.feed_update at 0x10920bc40>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f6360>
                     └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a0f6480>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a0f6540>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10ac8f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715040, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10ac8f920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a0f51c0'>>, Update(update_id=257715040, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x10920b240>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8f9c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0f55e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Dispatcher '0x10a0f51c0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x10920b240>
                     └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10ac8fa60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10920a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10920b2e0>
                 └ <Router '0x10929ea50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x10920a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a0ce750>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a0f51c0'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a0f51f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244821005321923', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a7727a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10a0e6200>, CallbackQuery(id='3684244821005321923', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x10a0f51f0>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x10a444ad0>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          └ <function process_generation at 0x10a0e65c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!', <aiogram.fsm.context.FSMContext object at 0...
                 └ <function process_generation at 0x10a0e6700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: привет!'
          │   └ <function Bot.send_chat_action at 0x1091a04a0>
          └ <aiogram.client.bot.Bot object at 0x10a0f51f0>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:44:53.682319+0300  INFO  Бот запущен
2024-10-13T23:44:53.682319+0300  INFO  Бот запущен
2024-10-13T23:45:00.067130+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:45:00.067130+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:45:00.067130+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:45:00.067130+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:45:00.067130+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T23:45:00.503078+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:45:00.503078+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:45:00.503078+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:45:00.503078+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:45:00.503078+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.370496+0300  ERROR  Ошибка с подсчётом количества вызовов: 'str' object has no attribute 'from_user'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-13T23:45:02.371612+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (62101), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1005e63e0>
    │       └ <function run at 0x100c4fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x105802640>
           │      └ <function Runner.run at 0x100cd14e0>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100cc6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057e8710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100cc6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100cd0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100c0e020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,)}
                     │    │           │    └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x105851070>
                     │    └ <function Dispatcher.feed_update at 0x104967c40>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x105852450>
                     └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x105852570>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x105852630>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10611b4c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715044, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10611b6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1058512e0'>>, Update(update_id=257715044, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x104967240>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1058516a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Dispatcher '0x1058512e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x104967240>
                     └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10611b7e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1049667a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1049672e0>
                 └ <Router '0x10495f410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x1049668e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10582a9c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1058512e0'>, 'bots': (<aiogram.client.bot.Bot object at 0x105851070>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824511396834', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10611b920>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x10583a200>, CallbackQuery(id='3684244824511396834', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 100, in process_callback_query
    await process_generation(response_received, state, bot)
          │                  │                  │      └ <aiogram.client.bot.Bot object at 0x105851070>
          │                  │                  └ <aiogram.fsm.context.FSMContext object at 0x1057b8f20>
          │                  └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          └ <function process_generation at 0x10583a5c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ ('Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!', <aiogram.fsm.context.FSMContext object at ...
                 └ <function process_generation at 0x10583a700>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    await bot.send_chat_action(message.chat.id, "typing")
          │   │                └ 'Мне не понравился ответ, попробуй ещё раз, вот мой предыдущий запрос: Привкет!'
          │   └ <function Bot.send_chat_action at 0x1048fc4a0>
          └ <aiogram.client.bot.Bot object at 0x105851070>

AttributeError: 'str' object has no attribute 'chat'
2024-10-14T00:20:52.863520+0300  INFO  Бот запущен
2024-10-14T00:20:52.863520+0300  INFO  Бот запущен
2024-10-14T00:21:23.890903+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:21:23.890903+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:21:23.890903+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:21:23.890903+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:21:23.890903+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:21:24.415900+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:21:24.415900+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:21:24.415900+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:21:24.415900+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:21:24.415900+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.365146+0300  ERROR  Ошибка при обработке запроса для пользователя 7488158267: (1264, "Out of range value for column 'telegram_id' at row 1")
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.366924+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (62560), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 29, in gpt
    await add_users(telegram_id)
          │         └ 7488158267
          └ <function add_users at 0x108ed16c0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/database/db.py", line 51, in add_users
    await cur.execute("""
          │   └ <function Cursor.execute at 0x108f80220>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 239, in execute
    await self._query(query)
          │    │      └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Cursor._query at 0x108f80720>
          └ <aiomysql.cursors.Cursor object at 0x10a17f530>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/cursors.py", line 457, in _query
    await conn.query(q)
          │    │     └ '\n                INSERT INTO users (telegram_id) VALUES (7488158267)\n            '
          │    └ <function Connection.query at 0x108f83ce0>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
          │    │                             └ False
          │    └ <function Connection._read_query_result at 0x108f84540>
          └ <aiomysql.connection.Connection object at 0x10a17f830>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 683, in _read_query_result
    await result.read()
          │      └ <function MySQLResult.read at 0x108f851c0>
          └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                         │    └ None
                         └ <aiomysql.connection.MySQLResult object at 0x10b57fe90>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiomysql/connection.py", line 652, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x108f4f7e0>
    └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x10b57fd00>
    │   └ <function raise_mysql_exception at 0x108ed1b20>
    └ <module 'pymysql.err' from '/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Out of range value for column 'telegram_id' at row 1"
          │          └ 1264
          └ <class 'pymysql.err.DataError'>

pymysql.err.DataError: (1264, "Out of range value for column 'telegram_id' at row 1")


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104aaa3e0>
    │       └ <function run at 0x105113c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109cc6740>
           │      └ <function Runner.run at 0x1051954e0>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10518afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1096f4710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10518af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105194d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1050d2020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,)}
                     │    │           │    └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109d194f0>
                     │    └ <function Dispatcher.feed_update at 0x108e2bc40>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d1a660>
                     └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109d1a780>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109d1a840>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a2762a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715048, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x10a050ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109d191f0'>>, Update(update_id=257715048, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x108e2b240>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a053920>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109d198e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Dispatcher '0x109d191f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x108e2b240>
                     └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a050b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108e2a7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108e2b2e0>
                 └ <Router '0x108dc7b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x108e2a8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cee7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109d191f0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109d194f0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10a77b7e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x109d06200>, CallbackQuery(id='3684244824472230699', from_user=User(id...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot)
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x109d194f0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10a05cda0>
          │                  │              └ Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244824472230699', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x109d068e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=2808, date=datetime.datetime(2024, 10, 13, 21, 21, 12, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109d06a20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 168, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 7488158267
                          │   │           └ 'gpt-4o-mini'
                          │   └ "Конечно! Вот простой пример нейросети, написанной на Python с использованием библиотеки TensorFlow и Keras. Этот пример созд...
                          └ <function gpt at 0x1098e3740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:21:34.508346+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T00:25:23.466862+0300  INFO  Бот запущен
2024-10-14T00:25:23.466862+0300  INFO  Бот запущен
2024-10-14T00:26:01.764995+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:01.764995+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:01.764995+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:01.764995+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:01.764995+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:02.465011+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:02.465011+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:02.465011+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:02.465011+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:02.465011+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.150981+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:45.465821+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:47.661542+0300  INFO  Добавлен новый пользователь с telegram_id: 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.747262+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:26:49.814320+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:31:01.983675+0300  INFO  Бот запущен
2024-10-14T00:31:01.983675+0300  INFO  Бот запущен
2024-10-14T00:32:12.292587+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:32:12.292587+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:32:12.292587+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:32:12.292587+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:32:12.292587+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:32:12.863823+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:32:12.863823+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:32:12.863823+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:32:12.863823+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:32:12.863823+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:40:49.862585+0300  INFO  Бот запущен
2024-10-14T00:40:49.862585+0300  INFO  Бот запущен
2024-10-14T00:41:36.062770+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:41:36.062770+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:41:36.062770+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:41:36.062770+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:41:36.062770+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:41:36.640423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:41:36.640423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:41:36.640423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:41:36.640423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:41:36.640423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.545238+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:43:43.738979+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.553543+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:53:06.629404+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:23.956570+0300  INFO  Бот запущен
2024-10-14T00:56:23.956570+0300  INFO  Бот запущен
2024-10-14T00:56:29.109647+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:56:29.109647+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:56:29.109647+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:56:29.109647+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:56:29.109647+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:56:29.513203+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:56:29.513203+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:56:29.513203+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:56:29.513203+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:56:29.513203+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.118926+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:56:34.351676+0300  INFO  Ответ gpt получен и отправлен пользователю: 7488158267
2024-10-14T00:58:09.160822+0300  INFO  Бот запущен
2024-10-14T00:58:09.160822+0300  INFO  Бот запущен
2024-10-14T00:58:19.956901+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:58:19.956901+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:58:19.956901+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:58:19.956901+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:58:19.956901+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:58:20.333120+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:58:20.333120+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:58:20.333120+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:58:20.333120+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:58:20.333120+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:58:23.297429+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'text'
2024-10-14T00:58:23.297429+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'text'
2024-10-14T00:58:23.297429+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'text'
2024-10-14T00:58:23.297429+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'text'
2024-10-14T00:58:23.297429+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'text'
2024-10-14T00:58:23.297429+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'text'
2024-10-14T00:58:41.940314+0300  INFO  Бот запущен
2024-10-14T00:58:41.940314+0300  INFO  Бот запущен
2024-10-14T00:59:00.847479+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:00.847479+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:00.847479+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:00.847479+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:00.847479+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:01.211436+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:01.211436+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:01.211436+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:01.211436+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:01.211436+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:03.318390+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'chat_id'
2024-10-14T00:59:03.318390+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'chat_id'
2024-10-14T00:59:03.318390+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'chat_id'
2024-10-14T00:59:03.318390+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'chat_id'
2024-10-14T00:59:03.318390+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'chat_id'
2024-10-14T00:59:03.318390+0300  ERROR  Ошибка при перегенерации ответа: Bot.send_message() missing 1 required positional argument: 'chat_id'
2024-10-14T00:59:32.281595+0300  INFO  Бот запущен
2024-10-14T00:59:32.281595+0300  INFO  Бот запущен
2024-10-14T00:59:38.144829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:38.144829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:38.144829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:38.144829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:38.144829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T00:59:38.610423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:38.610423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:38.610423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:38.610423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T00:59:38.610423+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:00:00.154779+0300  INFO  Бот запущен
2024-10-14T01:00:00.154779+0300  INFO  Бот запущен
2024-10-14T01:00:09.377829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:00:09.377829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:00:09.377829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:00:09.377829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:00:09.377829+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:00:09.755948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:00:09.755948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:00:09.755948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:00:09.755948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:00:09.755948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:38.920019+0300  INFO  Бот запущен
2024-10-14T01:06:38.920019+0300  INFO  Бот запущен
2024-10-14T01:06:44.556100+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:44.556100+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:44.556100+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:44.556100+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:44.556100+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:44.945398+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:44.945398+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:44.945398+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:44.945398+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:44.945398+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.163028+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:06:54.316255+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.534571+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:07:52.709479+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.652255+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:08:12.869577+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:11:22.112852+0300  INFO  Бот запущен
2024-10-14T01:11:22.112852+0300  INFO  Бот запущен
2024-10-14T01:11:27.579402+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:11:27.579402+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:11:27.579402+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:11:27.579402+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:11:27.579402+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:11:28.014998+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:11:28.014998+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:11:28.014998+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:11:28.014998+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:11:28.014998+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:11:31.251750+0300  ERROR  Ошибка при перегенерации ответа: 'user'
2024-10-14T01:11:31.251750+0300  ERROR  Ошибка при перегенерации ответа: 'user'
2024-10-14T01:11:31.251750+0300  ERROR  Ошибка при перегенерации ответа: 'user'
2024-10-14T01:11:31.251750+0300  ERROR  Ошибка при перегенерации ответа: 'user'
2024-10-14T01:11:31.251750+0300  ERROR  Ошибка при перегенерации ответа: 'user'
2024-10-14T01:11:31.251750+0300  ERROR  Ошибка при перегенерации ответа: 'user'
2024-10-14T01:12:23.402381+0300  INFO  Бот запущен
2024-10-14T01:12:23.402381+0300  INFO  Бот запущен
2024-10-14T01:12:27.878266+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:27.878266+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:27.878266+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:27.878266+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:27.878266+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:28.231332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:28.231332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:28.231332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:28.231332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:28.231332+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.670466+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:12:31.802118+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:12.769657+0300  INFO  Бот запущен
2024-10-14T01:13:12.769657+0300  INFO  Бот запущен
2024-10-14T01:13:19.295518+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:19.295518+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:19.295518+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:19.295518+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:19.295518+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:19.635394+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:19.635394+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:19.635394+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:19.635394+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:19.635394+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.205029+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:13:24.360349+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:14:36.131162+0300  INFO  Бот запущен
2024-10-14T01:14:36.131162+0300  INFO  Бот запущен
2024-10-14T01:15:12.284193+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:15:12.284193+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:15:12.284193+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:15:12.284193+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:15:12.284193+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:15:13.277680+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:15:13.277680+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:15:13.277680+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:15:13.277680+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:15:13.277680+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:15:29.746973+0300  ERROR  An error has been caught in function 'process_callback_query', process 'MainProcess' (63938), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102bfe3e0>
    │       └ <function run at 0x103267c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107e1a740>
           │      └ <function Runner.run at 0x1032e94e0>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032defc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107d0b530>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032def20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032e8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103226020>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,)}
                     │    │           │    └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107e68da0>
                     │    └ <function Dispatcher.feed_update at 0x106f7fc40>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e6a8a0>
                     └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107e6a9c0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107e6aa80>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function TelegramEventObserver.trigger at 0x10a829260>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715111, message=None, edited_message=None, channel_post=None, edited_channel_post=None, business_connecti...
                 └ <function CallableObject.call at 0x1081a4ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107e693d0'>>, Update(update_id=257715111, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x106f7f240>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a7740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e69af0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Dispatcher '0x107e693d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x106f7f240>
                     └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1081a77e0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x106f7e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x106f7f2e0>
                 └ <Router '0x106eeec90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                     │        │       └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                     │        └ <function TelegramEventObserver.trigger at 0x106f7e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107e42a50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107e693d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107e68da0>,), 'bot': <aiogram.client....
                 │             └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
                 └ <function CallableObject.call at 0x10aa43100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_callback_query at 0x107e56200>, CallbackQuery(id='3684244820874464865', from_user=User(id...

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 101, in process_callback_query
    await process_generation(callback_query.message, state, bot, length_more=True, telegram_id=telegram_id, user_message=user_message)
          │                  │              │        │      │                                  │                         └ 'Привет! Напиши нейросеть на python'
          │                  │              │        │      │                                  └ 857805093
          │                  │              │        │      └ <aiogram.client.bot.Bot object at 0x107e68da0>
          │                  │              │        └ <aiogram.fsm.context.FSMContext object at 0x10b9830b0>
          │                  │              └ Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          │                  └ CallbackQuery(id='3684244820874464865', from_user=User(id=857805093, is_bot=False, first_name='Александр', last_name='Волжани...
          └ <function process_generation at 0x107e568e0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'length_more': True, 'telegram_id': 857805093, 'user_message': 'Привет! Напиши нейросеть на python'}
                 │     └ (Message(message_id=2933, date=datetime.datetime(2024, 10, 13, 22, 14, 48, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107e56a20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 149, in process_generation
    lenght_message_user = calculate_message_length(user_input)
                          └ <function calculate_message_length at 0x107e54180>

UnboundLocalError: cannot access local variable 'user_input' where it is not associated with a value
2024-10-14T01:16:16.683544+0300  INFO  Бот запущен
2024-10-14T01:16:16.683544+0300  INFO  Бот запущен
2024-10-14T01:17:05.557678+0300  INFO  Бот запущен
2024-10-14T01:17:05.557678+0300  INFO  Бот запущен
2024-10-14T01:17:12.776017+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:12.776017+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:12.776017+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:12.776017+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:12.776017+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:13.104126+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:13.104126+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:13.104126+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:13.104126+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:13.104126+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.653532+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:16.764556+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.028731+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:17:42.155267+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.683814+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:18:43.870596+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:21:02.987679+0300  INFO  Бот запущен
2024-10-14T01:21:02.987679+0300  INFO  Бот запущен
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.719851+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:22:04.813071+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-14T01:51:03.616313+0300  INFO  Бот запущен
2024-10-14T01:51:03.616313+0300  INFO  Бот запущен
2024-10-14T01:51:19.936313+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:51:19.936313+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:51:19.936313+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:51:19.936313+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:51:19.936313+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:51:19.937579+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (64992), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша'}, {'role': 'assistant', 'content': 'Привет, Саша! Как я могу помочь тебе сегод...
          │                    └ 857805093
          └ <function save_message_history at 0x1091df560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104d2a3e0>
    │       └ <function run at 0x105393c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109f46540>
           │      └ <function Runner.run at 0x1054154e0>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10540afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10540af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105414d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105352020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,)}
                     │    │           │    └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109f94e60>
                     │    └ <function Dispatcher.feed_update at 0x1090abc40>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f96150>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109f96270>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109f96330>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a2d27a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a2d0680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109f94ef0'>>, Update(update_id=257715134, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1090ab240>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d3420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f95040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1090ab240>
                     └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d34c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1090aa8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a2d3380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109f86660>, Message(message_id=2980, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f97fe0>, 'bot': <aiogram.client.bot.Bot object at 0x109f94e60>}
                 │     └ (Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109f865c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша'
                          └ <function gpt at 0x109b63740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:51:19.937579+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (64992), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша'}, {'role': 'assistant', 'content': 'Привет, Саша! Как я могу помочь тебе сегод...
          │                    └ 857805093
          └ <function save_message_history at 0x1091df560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104d2a3e0>
    │       └ <function run at 0x105393c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109f46540>
           │      └ <function Runner.run at 0x1054154e0>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10540afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10540af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105414d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105352020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,)}
                     │    │           │    └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109f94e60>
                     │    └ <function Dispatcher.feed_update at 0x1090abc40>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f96150>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109f96270>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109f96330>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a2d27a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a2d0680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109f94ef0'>>, Update(update_id=257715134, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1090ab240>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d3420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f95040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1090ab240>
                     └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d34c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1090aa8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a2d3380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109f86660>, Message(message_id=2980, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f97fe0>, 'bot': <aiogram.client.bot.Bot object at 0x109f94e60>}
                 │     └ (Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109f865c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша'
                          └ <function gpt at 0x109b63740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:51:19.937579+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (64992), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша'}, {'role': 'assistant', 'content': 'Привет, Саша! Как я могу помочь тебе сегод...
          │                    └ 857805093
          └ <function save_message_history at 0x1091df560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104d2a3e0>
    │       └ <function run at 0x105393c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109f46540>
           │      └ <function Runner.run at 0x1054154e0>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10540afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10540af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105414d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105352020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,)}
                     │    │           │    └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109f94e60>
                     │    └ <function Dispatcher.feed_update at 0x1090abc40>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f96150>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109f96270>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109f96330>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a2d27a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a2d0680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109f94ef0'>>, Update(update_id=257715134, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1090ab240>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d3420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f95040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1090ab240>
                     └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d34c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1090aa8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a2d3380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109f86660>, Message(message_id=2980, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f97fe0>, 'bot': <aiogram.client.bot.Bot object at 0x109f94e60>}
                 │     └ (Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109f865c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша'
                          └ <function gpt at 0x109b63740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:51:19.937579+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (64992), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша'}, {'role': 'assistant', 'content': 'Привет, Саша! Как я могу помочь тебе сегод...
          │                    └ 857805093
          └ <function save_message_history at 0x1091df560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104d2a3e0>
    │       └ <function run at 0x105393c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109f46540>
           │      └ <function Runner.run at 0x1054154e0>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10540afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10540af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105414d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105352020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,)}
                     │    │           │    └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109f94e60>
                     │    └ <function Dispatcher.feed_update at 0x1090abc40>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f96150>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109f96270>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109f96330>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a2d27a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a2d0680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109f94ef0'>>, Update(update_id=257715134, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1090ab240>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d3420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f95040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1090ab240>
                     └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d34c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1090aa8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a2d3380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109f86660>, Message(message_id=2980, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f97fe0>, 'bot': <aiogram.client.bot.Bot object at 0x109f94e60>}
                 │     └ (Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109f865c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша'
                          └ <function gpt at 0x109b63740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:51:19.937579+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (64992), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша'}, {'role': 'assistant', 'content': 'Привет, Саша! Как я могу помочь тебе сегод...
          │                    └ 857805093
          └ <function save_message_history at 0x1091df560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104d2a3e0>
    │       └ <function run at 0x105393c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109f46540>
           │      └ <function Runner.run at 0x1054154e0>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10540afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109f77e30>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10540af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105414d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105352020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a5ff580>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,)}
                     │    │           │    └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109f94e60>
                     │    └ <function Dispatcher.feed_update at 0x1090abc40>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f96150>
                     └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109f96270>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109f96330>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a2d27a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715134, message=Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a2d0680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109f94ef0'>>, Update(update_id=257715134, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1090ab240>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d3420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109f95040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Dispatcher '0x109f94ef0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1090ab240>
                     └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a2d34c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1090aa7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1090ab2e0>
                 └ <Router '0x10913eb40'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1090aa8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10913d9d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109f94ef0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109f94e60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a2d3380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109f86660>, Message(message_id=2980, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f97fe0>, 'bot': <aiogram.client.bot.Bot object at 0x109f94e60>}
                 │     └ (Message(message_id=2980, date=datetime.datetime(2024, 10, 13, 22, 51, 17, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109f865c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша'
                          └ <function gpt at 0x109b63740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:51:19.976604+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:51:19.976604+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:51:19.976604+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:51:19.976604+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:51:19.976604+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:55:31.430260+0300  INFO  Бот запущен
2024-10-14T01:55:31.430260+0300  INFO  Бот запущен
2024-10-14T01:55:43.927653+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:55:43.927653+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:55:43.927653+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:55:43.927653+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:55:43.927653+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: save_message_history() missing 1 required positional argument: 'model'
2024-10-14T01:55:43.930251+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (65163), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша!'}, {'role': 'assistant', 'content': 'Привет, Саша! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108f17560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104a663e0>
    │       └ <function run at 0x1050cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109c7e540>
           │      └ <function Runner.run at 0x1051514e0>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105146fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105146f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105150d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10508e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,)}
                     │    │           │    └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109cd0d40>
                     │    └ <function Dispatcher.feed_update at 0x108de7c40>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd2330>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109cd2450>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109cd2510>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109cb7100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a00c680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109cd10d0'>>, Update(update_id=257715138, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108de7240>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd0dd0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108de7240>
                     └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108de68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a00f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109cb6660>, Message(message_id=2988, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a133110>, 'bot': <aiogram.client.bot.Bot object at 0x109cd0d40>}
                 │     └ (Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109cb65c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша!'
                          └ <function gpt at 0x10989b740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:55:43.930251+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (65163), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша!'}, {'role': 'assistant', 'content': 'Привет, Саша! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108f17560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104a663e0>
    │       └ <function run at 0x1050cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109c7e540>
           │      └ <function Runner.run at 0x1051514e0>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105146fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105146f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105150d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10508e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,)}
                     │    │           │    └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109cd0d40>
                     │    └ <function Dispatcher.feed_update at 0x108de7c40>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd2330>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109cd2450>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109cd2510>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109cb7100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a00c680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109cd10d0'>>, Update(update_id=257715138, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108de7240>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd0dd0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108de7240>
                     └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108de68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a00f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109cb6660>, Message(message_id=2988, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a133110>, 'bot': <aiogram.client.bot.Bot object at 0x109cd0d40>}
                 │     └ (Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109cb65c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша!'
                          └ <function gpt at 0x10989b740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:55:43.930251+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (65163), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша!'}, {'role': 'assistant', 'content': 'Привет, Саша! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108f17560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104a663e0>
    │       └ <function run at 0x1050cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109c7e540>
           │      └ <function Runner.run at 0x1051514e0>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105146fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105146f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105150d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10508e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,)}
                     │    │           │    └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109cd0d40>
                     │    └ <function Dispatcher.feed_update at 0x108de7c40>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd2330>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109cd2450>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109cd2510>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109cb7100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a00c680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109cd10d0'>>, Update(update_id=257715138, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108de7240>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd0dd0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108de7240>
                     └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108de68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a00f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109cb6660>, Message(message_id=2988, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a133110>, 'bot': <aiogram.client.bot.Bot object at 0x109cd0d40>}
                 │     └ (Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109cb65c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша!'
                          └ <function gpt at 0x10989b740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:55:43.930251+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (65163), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша!'}, {'role': 'assistant', 'content': 'Привет, Саша! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108f17560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104a663e0>
    │       └ <function run at 0x1050cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109c7e540>
           │      └ <function Runner.run at 0x1051514e0>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105146fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105146f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105150d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10508e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,)}
                     │    │           │    └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109cd0d40>
                     │    └ <function Dispatcher.feed_update at 0x108de7c40>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd2330>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109cd2450>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109cd2510>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109cb7100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a00c680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109cd10d0'>>, Update(update_id=257715138, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108de7240>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd0dd0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108de7240>
                     └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108de68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a00f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109cb6660>, Message(message_id=2988, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a133110>, 'bot': <aiogram.client.bot.Bot object at 0x109cd0d40>}
                 │     └ (Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109cb65c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша!'
                          └ <function gpt at 0x10989b740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:55:43.930251+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (65163), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 60, in gpt
    await save_message_history(telegram_id, message_history[-2:])
          │                    │            └ [{'role': 'user', 'content': 'Меня зовут Саша!'}, {'role': 'assistant', 'content': 'Привет, Саша! Как дела? Чем могу помочь?'}]
          │                    └ 857805093
          └ <function save_message_history at 0x108f17560>

TypeError: save_message_history() missing 1 required positional argument: 'model'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x104a663e0>
    │       └ <function run at 0x1050cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109c7e540>
           │      └ <function Runner.run at 0x1051514e0>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105146fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109937110>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105146f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105150d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10508e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a33b8e0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,)}
                     │    │           │    └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109cd0d40>
                     │    └ <function Dispatcher.feed_update at 0x108de7c40>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd2330>
                     └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109cd2450>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109cd2510>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x109cb7100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257715138, message=Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10a00c680>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109cd10d0'>>, Update(update_id=257715138, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108de7240>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109cd0dd0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Dispatcher '0x109cd10d0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108de7240>
                     └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10a00f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108de67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108de72e0>
                 └ <Router '0x108de3b90'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x108de68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108bc5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109cd10d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109cd0d40>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a00f6a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109cb6660>, Message(message_id=2988, date=datetime.datetime(2024, 10, 13,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a133110>, 'bot': <aiogram.client.bot.Bot object at 0x109cd0d40>}
                 │     └ (Message(message_id=2988, date=datetime.datetime(2024, 10, 13, 22, 55, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x109cb65c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 141, in process_generation
    text_from_gpt = await gpt(user_input, model, telegram_id)
                          │   │           │      └ 857805093
                          │   │           └ 'gpt-4o-mini'
                          │   └ 'Меня зовут Саша!'
                          └ <function gpt at 0x10989b740>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T01:55:43.976615+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:55:43.976615+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:55:43.976615+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:55:43.976615+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:55:43.976615+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-14T01:56:15.356585+0300  INFO  Бот запущен
2024-10-14T01:56:15.356585+0300  INFO  Бот запущен
2024-10-14T01:56:26.197999+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:26.197999+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:26.197999+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:26.197999+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:26.197999+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:26.779453+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:26.779453+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:26.779453+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:26.779453+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:26.779453+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.839606+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:35.991886+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.842877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:42.977923+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.117362+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:56:46.312539+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:58:35.232231+0300  INFO  Бот запущен
2024-10-14T01:58:35.232231+0300  INFO  Бот запущен
2024-10-14T01:59:29.356928+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:29.356928+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:29.356928+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:29.356928+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:29.356928+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:29.743019+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:29.743019+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:29.743019+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:29.743019+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:29.743019+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.544455+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:33.688967+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.093407+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:38.229691+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.260694+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T01:59:50.446405+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.440771+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:00:03.609041+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.254356+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:01:51.686036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.001454+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:08.145048+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.241022+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:21.375445+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.071575+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:02:31.232263+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T02:36:31.357257+0300  INFO  Бот запущен
2024-10-14T02:36:31.357257+0300  INFO  Бот запущен
2024-10-14T03:07:47.682898+0300  INFO  Бот запущен
2024-10-14T03:07:47.682898+0300  INFO  Бот запущен
2024-10-14T03:08:30.155967+0300  INFO  Бот запущен
2024-10-14T03:08:30.155967+0300  INFO  Бот запущен
2024-10-14T03:08:57.396016+0300  INFO  Бот запущен
2024-10-14T03:08:57.396016+0300  INFO  Бот запущен
2024-10-14T03:11:32.684337+0300  INFO  Бот запущен
2024-10-14T03:11:32.684337+0300  INFO  Бот запущен
2024-10-14T18:59:18.717091+0300  INFO  Бот запущен
2024-10-14T18:59:18.717091+0300  INFO  Бот запущен
2024-10-14T19:05:16.110974+0300  INFO  Бот запущен
2024-10-14T19:05:16.110974+0300  INFO  Бот запущен
2024-10-14T19:09:27.002285+0300  INFO  Бот запущен
2024-10-14T19:09:27.002285+0300  INFO  Бот запущен
2024-10-14T19:09:50.965296+0300  INFO  Бот запущен
2024-10-14T19:09:50.965296+0300  INFO  Бот запущен
2024-10-14T19:10:08.123656+0300  INFO  Бот запущен
2024-10-14T19:10:08.123656+0300  INFO  Бот запущен
2024-10-14T19:10:31.765416+0300  INFO  Бот запущен
2024-10-14T19:10:31.765416+0300  INFO  Бот запущен
2024-10-14T19:14:18.230264+0300  INFO  Бот запущен
2024-10-14T19:14:18.230264+0300  INFO  Бот запущен
2024-10-14T19:14:51.714715+0300  INFO  Бот запущен
2024-10-14T19:14:51.714715+0300  INFO  Бот запущен
2024-10-14T19:15:01.972267+0300  INFO  Бот запущен
2024-10-14T19:15:01.972267+0300  INFO  Бот запущен
2024-10-14T19:15:49.968689+0300  INFO  Бот запущен
2024-10-14T19:15:49.968689+0300  INFO  Бот запущен
2024-10-14T19:16:23.542105+0300  INFO  Бот запущен
2024-10-14T19:16:23.542105+0300  INFO  Бот запущен
2024-10-14T19:16:46.496833+0300  INFO  Бот запущен
2024-10-14T19:16:46.496833+0300  INFO  Бот запущен
2024-10-14T19:17:48.654152+0300  INFO  Бот запущен
2024-10-14T19:17:48.654152+0300  INFO  Бот запущен
2024-10-14T19:19:21.003998+0300  INFO  Бот запущен
2024-10-14T19:19:21.003998+0300  INFO  Бот запущен
2024-10-14T19:20:34.661428+0300  INFO  Бот запущен
2024-10-14T19:20:34.661428+0300  INFO  Бот запущен
2024-10-14T19:21:20.441764+0300  INFO  Бот запущен
2024-10-14T19:21:20.441764+0300  INFO  Бот запущен
2024-10-14T19:22:33.635332+0300  INFO  Бот запущен
2024-10-14T19:22:33.635332+0300  INFO  Бот запущен
2024-10-14T19:22:56.492004+0300  INFO  Бот запущен
2024-10-14T19:22:56.492004+0300  INFO  Бот запущен
2024-10-14T19:25:53.960157+0300  INFO  Бот запущен
2024-10-14T19:25:53.960157+0300  INFO  Бот запущен
2024-10-14T19:29:14.949984+0300  INFO  Бот запущен
2024-10-14T19:29:14.949984+0300  INFO  Бот запущен
2024-10-14T19:29:42.985285+0300  INFO  Бот запущен
2024-10-14T19:29:42.985285+0300  INFO  Бот запущен
2024-10-14T19:30:00.100764+0300  ERROR  An error has been caught in function 'error_handling', process 'MainProcess' (22257), thread 'MainThread' (140292976314176):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f986ebd0900>
    │       └ <function run at 0x7f987214df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f986dcb1840>
           │      └ <function Runner.run at 0x7f98721ef7e0>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f98721ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f98721ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f98721ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f9872139580>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,)}
                     │    │           │    └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f986dcc90d0>
                     │    └ <function Dispatcher.feed_update at 0x7f986ee2f600>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986dcca450>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f986dcca570>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f986dcca630>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x7f986db20720>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x7f986db21da0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f986dcc9070'>>, Update(update_id=257715201, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f986ee2ec00>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db21120>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986e54b9e0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f986ee2ec00>
                     └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db211c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x7f986ee2e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x7f986dcce5c0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f986dccc9a0>, Message(message_id=3121, date=datetime.datetime(2024, 10, 14, ...

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state)
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f986d10bd40>
          │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
          └ <function process_generation at 0x7f986dccc4a0>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x7f986dccc5e0>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-14T19:30:00.100764+0300  ERROR  An error has been caught in function 'error_handling', process 'MainProcess' (22257), thread 'MainThread' (140292976314176):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f986ebd0900>
    │       └ <function run at 0x7f987214df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f986dcb1840>
           │      └ <function Runner.run at 0x7f98721ef7e0>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f98721ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f98721ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f98721ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f9872139580>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,)}
                     │    │           │    └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f986dcc90d0>
                     │    └ <function Dispatcher.feed_update at 0x7f986ee2f600>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986dcca450>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f986dcca570>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f986dcca630>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x7f986db20720>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x7f986db21da0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f986dcc9070'>>, Update(update_id=257715201, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f986ee2ec00>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db21120>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986e54b9e0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f986ee2ec00>
                     └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db211c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x7f986ee2e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x7f986dcce5c0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f986dccc9a0>, Message(message_id=3121, date=datetime.datetime(2024, 10, 14, ...

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state)
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f986d10bd40>
          │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
          └ <function process_generation at 0x7f986dccc4a0>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x7f986dccc5e0>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-14T19:30:00.100764+0300  ERROR  An error has been caught in function 'error_handling', process 'MainProcess' (22257), thread 'MainThread' (140292976314176):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f986ebd0900>
    │       └ <function run at 0x7f987214df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f986dcb1840>
           │      └ <function Runner.run at 0x7f98721ef7e0>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f98721ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f98721ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f98721ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f9872139580>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,)}
                     │    │           │    └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f986dcc90d0>
                     │    └ <function Dispatcher.feed_update at 0x7f986ee2f600>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986dcca450>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f986dcca570>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f986dcca630>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x7f986db20720>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x7f986db21da0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f986dcc9070'>>, Update(update_id=257715201, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f986ee2ec00>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db21120>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986e54b9e0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f986ee2ec00>
                     └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db211c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x7f986ee2e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x7f986dcce5c0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f986dccc9a0>, Message(message_id=3121, date=datetime.datetime(2024, 10, 14, ...

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state)
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f986d10bd40>
          │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
          └ <function process_generation at 0x7f986dccc4a0>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x7f986dccc5e0>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-14T19:30:00.100764+0300  ERROR  An error has been caught in function 'error_handling', process 'MainProcess' (22257), thread 'MainThread' (140292976314176):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f986ebd0900>
    │       └ <function run at 0x7f987214df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f986dcb1840>
           │      └ <function Runner.run at 0x7f98721ef7e0>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f98721ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f9872bff470>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f98721ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f98721ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f9872139580>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,)}
                     │    │           │    └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f986dcc90d0>
                     │    └ <function Dispatcher.feed_update at 0x7f986ee2f600>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986dcca450>
                     └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f986dcca570>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f986dcca630>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x7f986db20720>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715201, message=Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x7f986db21da0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f986dcc9070'>>, Update(update_id=257715201, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f986ee2ec00>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db21120>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986e54b9e0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Dispatcher '0x7f986dcc9070'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f986ee2ec00>
                     └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f986db211c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f986ee2e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f986ee2eca0>
                 └ <Router '0x7f986ebc5550'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x7f986ee2e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f986ebc5580>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f986dcc9070'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f986dcc90d0>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x7f986dcce5c0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f986dccc9a0>, Message(message_id=3121, date=datetime.datetime(2024, 10, 14, ...

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state)
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f986d10bd40>
          │                  └ Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
          └ <function process_generation at 0x7f986dccc4a0>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3121, date=datetime.datetime(2024, 10, 14, 16, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x7f986dccc5e0>

TypeError: process_generation() missing 1 required positional argument: 'bot'
2024-10-14T19:30:31.473942+0300  INFO  Бот запущен
2024-10-14T19:30:31.473942+0300  INFO  Бот запущен
2024-10-14T19:30:36.408569+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}
2024-10-14T19:30:36.408569+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}
2024-10-14T19:30:36.408569+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}
2024-10-14T19:30:36.408569+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}
2024-10-14T19:30:36.408569+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}
2024-10-14T19:30:36.408827+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (22595), thread 'MainThread' (140138594416448):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 46, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x7f747c5bb240>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x7f747b307b90>
                     └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x7f747c5eba70>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x7f747c7ad800>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x7f747c7ad8a0>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f747c7a68e0>
          └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

openai.BadRequestError: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f747cdc09a0>
    │       └ <function run at 0x7f748034df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f747beb1840>
           │      └ <function Runner.run at 0x7f74803ef7e0>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f74803ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f74803ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f74803ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f7480339580>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,)}
                     │    │           │    └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
                     │    └ <function Dispatcher.feed_update at 0x7f747d01f600>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec6300>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f747bec6420>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f747bec64e0>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x7f747bd1d120>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x7f747bd1d080>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f747bea5e80'>>, Update(update_id=257715203, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f747d01ec00>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d1c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec4dd0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f747d01ec00>
                     └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d260>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x7f747d01e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x7f747bd1d440>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f747bec8a40>, Message(message_id=3124, date=datetime.datetime(2024, 10, 14, ...

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state, bot)
          │                  │        │      └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f747beeca10>
          │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          └ <function process_generation at 0x7f747bec8540>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x7f747bec8680>

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 147, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ None
                     │   └ 'Привет1'
                     └ <function gpt at 0x7f747c3d0d60>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T19:30:36.408827+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (22595), thread 'MainThread' (140138594416448):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 46, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x7f747c5bb240>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x7f747b307b90>
                     └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x7f747c5eba70>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x7f747c7ad800>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x7f747c7ad8a0>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f747c7a68e0>
          └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

openai.BadRequestError: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f747cdc09a0>
    │       └ <function run at 0x7f748034df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f747beb1840>
           │      └ <function Runner.run at 0x7f74803ef7e0>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f74803ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f74803ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f74803ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f7480339580>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,)}
                     │    │           │    └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
                     │    └ <function Dispatcher.feed_update at 0x7f747d01f600>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec6300>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f747bec6420>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f747bec64e0>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x7f747bd1d120>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x7f747bd1d080>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f747bea5e80'>>, Update(update_id=257715203, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f747d01ec00>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d1c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec4dd0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f747d01ec00>
                     └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d260>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x7f747d01e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x7f747bd1d440>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f747bec8a40>, Message(message_id=3124, date=datetime.datetime(2024, 10, 14, ...

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state, bot)
          │                  │        │      └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f747beeca10>
          │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          └ <function process_generation at 0x7f747bec8540>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x7f747bec8680>

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 147, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ None
                     │   └ 'Привет1'
                     └ <function gpt at 0x7f747c3d0d60>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T19:30:36.408827+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (22595), thread 'MainThread' (140138594416448):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 46, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x7f747c5bb240>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x7f747b307b90>
                     └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x7f747c5eba70>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x7f747c7ad800>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x7f747c7ad8a0>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f747c7a68e0>
          └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

openai.BadRequestError: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f747cdc09a0>
    │       └ <function run at 0x7f748034df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f747beb1840>
           │      └ <function Runner.run at 0x7f74803ef7e0>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f74803ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f74803ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f74803ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f7480339580>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,)}
                     │    │           │    └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
                     │    └ <function Dispatcher.feed_update at 0x7f747d01f600>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec6300>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f747bec6420>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f747bec64e0>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x7f747bd1d120>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x7f747bd1d080>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f747bea5e80'>>, Update(update_id=257715203, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f747d01ec00>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d1c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec4dd0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f747d01ec00>
                     └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d260>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x7f747d01e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x7f747bd1d440>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f747bec8a40>, Message(message_id=3124, date=datetime.datetime(2024, 10, 14, ...

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state, bot)
          │                  │        │      └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f747beeca10>
          │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          └ <function process_generation at 0x7f747bec8540>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x7f747bec8680>

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 147, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ None
                     │   └ 'Привет1'
                     └ <function gpt at 0x7f747c3d0d60>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T19:30:36.408827+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (22595), thread 'MainThread' (140138594416448):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 46, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x7f747c5bb240>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x7f747b307b90>
                     └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x7f747c5eba70>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x7f747c7ad800>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x7f747c7ad8a0>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f747c7a68e0>
          └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

openai.BadRequestError: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f747cdc09a0>
    │       └ <function run at 0x7f748034df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f747beb1840>
           │      └ <function Runner.run at 0x7f74803ef7e0>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f74803ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f74803ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f74803ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f7480339580>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,)}
                     │    │           │    └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
                     │    └ <function Dispatcher.feed_update at 0x7f747d01f600>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec6300>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f747bec6420>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f747bec64e0>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x7f747bd1d120>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x7f747bd1d080>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f747bea5e80'>>, Update(update_id=257715203, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f747d01ec00>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d1c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec4dd0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f747d01ec00>
                     └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d260>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x7f747d01e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x7f747bd1d440>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f747bec8a40>, Message(message_id=3124, date=datetime.datetime(2024, 10, 14, ...

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state, bot)
          │                  │        │      └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f747beeca10>
          │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          └ <function process_generation at 0x7f747bec8540>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x7f747bec8680>

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 147, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ None
                     │   └ 'Привет1'
                     └ <function gpt at 0x7f747c3d0d60>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T19:30:36.408827+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (22595), thread 'MainThread' (140138594416448):
Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 46, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x7f747c5bb240>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x7f747b307b90>
                     └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x7f747c5eba70>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x7f747bdea6f0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x7f747c7ad800>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x7f747c7ad8a0>
                 └ <openai.AsyncOpenAI object at 0x7f747c5eba70>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f747c7a68e0>
          └ <openai.AsyncOpenAI object at 0x7f747c5eba70>

openai.BadRequestError: Error code: 400 - {'error': {'message': 'you must provide a model parameter', 'type': 'invalid_request_error', 'param': None, 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x7f747cdc09a0>
    │       └ <function run at 0x7f748034df80>
    └ <module 'asyncio' from '/usr/lib64/python3.12/asyncio/__init__.py'>

  File "/usr/lib64/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x7f747beb1840>
           │      └ <function Runner.run at 0x7f74803ef7e0>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f74803ed440>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f747c4674d0>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f74803ed3a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f74803ef1a0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib64/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f7480339580>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/usr/lib64/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x7f747b2f5930>()>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,)}
                     │    │           │    └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
                     │    └ <function Dispatcher.feed_update at 0x7f747d01f600>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec6300>
                     └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x7f747bec6420>, functools.par...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x7f747bec64e0>, <function TelegramEventObserver.tri...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │       └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x7f747bd1d120>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Update(update_id=257715203, message=Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x7f747bd1d080>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x7f747bea5e80'>>, Update(update_id=257715203, mess...
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │    │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x7f747d01ec00>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d1c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747bec4dd0>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Dispatcher '0x7f747bea5e80'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │      │                           │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x7f747d01ec00>
                     └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │        │                     │               └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x7f747bd1d260>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x7f747d01e160>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x7f747d01eca0>
                 └ <Router '0x7f747d6936e0'>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                     │        │       └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x7f747d01e2a0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x7f747cdb5250>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x7f747bea5e80'>, 'bots': (<aiogram.client.bot.Bot object at 0x7f747bec5100>,), 'bot': <aiogram.c...
                 │             └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x7f747bd1d440>
  File "/home/alexandervolzhanin/.cache/pypoetry/virtualenvs/chat-gpt-BzapIua5-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function error_handling at 0x7f747bec8a40>, Message(message_id=3124, date=datetime.datetime(2024, 10, 14, ...

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 216, in error_handling
    await process_generation(message, state, bot)
          │                  │        │      └ <aiogram.client.bot.Bot object at 0x7f747bec5100>
          │                  │        └ <aiogram.fsm.context.FSMContext object at 0x7f747beeca10>
          │                  └ Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
          └ <function process_generation at 0x7f747bec8540>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {}
                 │     └ (Message(message_id=3124, date=datetime.datetime(2024, 10, 14, 16, 30, 35, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x7f747bec8680>

> File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/handlers.py", line 147, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ None
                     │   └ 'Привет1'
                     └ <function gpt at 0x7f747c3d0d60>

  File "/home/alexandervolzhanin/pet-project/CHATGPT_BOT/app/generators.py", line 67, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-14T19:30:36.434217+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-14T19:30:36.434217+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-14T19:30:36.434217+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-14T19:30:36.434217+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-14T19:30:36.434217+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-14T19:32:07.140577+0300  INFO  Бот запущен
2024-10-14T19:32:07.140577+0300  INFO  Бот запущен
2024-10-14T19:32:18.673828+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:32:18.673828+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:32:18.673828+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:32:18.673828+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:32:18.673828+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:32:21.090975+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:32:21.090975+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:32:21.090975+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:32:21.090975+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:32:21.090975+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:35:15.736800+0300  INFO  Бот запущен
2024-10-14T19:35:15.736800+0300  INFO  Бот запущен
2024-10-14T19:35:29.830218+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:35:29.830218+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:35:29.830218+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:35:29.830218+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:35:29.830218+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:35:30.176058+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:35:30.176058+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:35:30.176058+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:35:30.176058+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:35:30.176058+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:36:32.473517+0300  INFO  Бот запущен
2024-10-14T19:36:32.473517+0300  INFO  Бот запущен
2024-10-14T19:36:55.929365+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:36:55.929365+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:36:55.929365+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:36:55.929365+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:36:55.929365+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:36:56.379062+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:36:56.379062+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:36:56.379062+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:36:56.379062+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:36:56.379062+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.788050+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:37:21.948264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:43.853559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:44.009667+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.367823+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:38:54.522652+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:06.110247+0300  INFO  Бот запущен
2024-10-14T19:39:06.110247+0300  INFO  Бот запущен
2024-10-14T19:39:11.917038+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:11.917038+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:11.917038+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:11.917038+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:11.917038+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:12.458420+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:12.458420+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:12.458420+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:12.458420+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:12.458420+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.124983+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:16.256855+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:22.952972+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:23.210964+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.324579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:39:29.460916+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:40:06.381976+0300  INFO  Бот запущен
2024-10-14T19:40:06.381976+0300  INFO  Бот запущен
2024-10-14T19:40:44.310346+0300  INFO  Бот запущен
2024-10-14T19:40:44.310346+0300  INFO  Бот запущен
2024-10-14T19:41:44.183255+0300  INFO  Бот запущен
2024-10-14T19:41:44.183255+0300  INFO  Бот запущен
2024-10-14T19:41:52.179177+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:41:52.179177+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:41:52.179177+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:41:52.179177+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:41:52.179177+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:41:52.529528+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:41:52.529528+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:41:52.529528+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:41:52.529528+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:41:52.529528+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.116888+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:00.637415+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:28.867696+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:43:29.003024+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Can't find end of the entity starting at byte offset 3198
2024-10-14T19:45:36.124529+0300  INFO  Бот запущен
2024-10-14T19:45:36.124529+0300  INFO  Бот запущен
2024-10-14T19:45:59.195540+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:45:59.195540+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:45:59.195540+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:45:59.195540+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:45:59.195540+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:45:59.617594+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:45:59.617594+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:45:59.617594+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:45:59.617594+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:45:59.617594+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:46:33.432097+0300  INFO  Бот запущен
2024-10-14T19:46:33.432097+0300  INFO  Бот запущен
2024-10-14T19:47:15.407248+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:47:15.407248+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:47:15.407248+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:47:15.407248+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:47:15.407248+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:47:15.853979+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:47:15.853979+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:47:15.853979+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:47:15.853979+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:47:15.853979+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:48:51.525238+0300  INFO  Бот запущен
2024-10-14T19:48:51.525238+0300  INFO  Бот запущен
2024-10-14T19:49:25.087444+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:49:25.087444+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:49:25.087444+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:49:25.087444+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:49:25.087444+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:49:25.602001+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:49:25.602001+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:49:25.602001+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:49:25.602001+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:49:25.602001+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:49:59.918993+0300  INFO  Бот запущен
2024-10-14T19:49:59.918993+0300  INFO  Бот запущен
2024-10-14T19:50:23.077137+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:50:23.077137+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:50:23.077137+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:50:23.077137+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:50:23.077137+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T19:50:23.540889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:50:23.540889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:50:23.540889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:50:23.540889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:50:23.540889+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T19:54:29.256651+0300  INFO  Бот запущен
2024-10-14T19:54:29.256651+0300  INFO  Бот запущен
2024-10-14T19:56:44.502005+0300  INFO  Бот запущен
2024-10-14T19:56:44.502005+0300  INFO  Бот запущен
2024-10-14T20:50:17.135374+0300  INFO  Бот запущен
2024-10-14T20:50:17.135374+0300  INFO  Бот запущен
2024-10-14T20:51:13.317303+0300  INFO  Бот запущен
2024-10-14T20:51:13.317303+0300  INFO  Бот запущен
2024-10-14T20:51:22.850166+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:51:22.850166+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:51:22.850166+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:51:22.850166+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:51:22.850166+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:51:23.222154+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:51:23.222154+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:51:23.222154+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:51:23.222154+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:51:23.222154+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:53:20.778278+0300  INFO  Бот запущен
2024-10-14T20:53:20.778278+0300  INFO  Бот запущен
2024-10-14T20:53:30.747836+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:53:30.747836+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:53:30.747836+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:53:30.747836+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:53:30.747836+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:53:31.235738+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:53:31.235738+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:53:31.235738+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:53:31.235738+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:53:31.235738+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:53:40.039789+0300  INFO  Бот запущен
2024-10-14T20:53:40.039789+0300  INFO  Бот запущен
2024-10-14T20:54:32.758079+0300  INFO  Бот запущен
2024-10-14T20:54:32.758079+0300  INFO  Бот запущен
2024-10-14T20:57:15.505948+0300  INFO  Бот запущен
2024-10-14T20:57:15.505948+0300  INFO  Бот запущен
2024-10-14T20:58:11.914517+0300  INFO  Бот запущен
2024-10-14T20:58:11.914517+0300  INFO  Бот запущен
2024-10-14T20:58:32.170833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:32.170833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:32.170833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:32.170833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:32.170833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:32.560618+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:32.560618+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:32.560618+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:32.560618+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:32.560618+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.005112+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:58:55.275615+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T20:59:39.424546+0300  INFO  Бот запущен
2024-10-14T20:59:39.424546+0300  INFO  Бот запущен
2024-10-14T21:00:25.353103+0300  INFO  Бот запущен
2024-10-14T21:00:25.353103+0300  INFO  Бот запущен
2024-10-14T21:01:50.630708+0300  INFO  Бот запущен
2024-10-14T21:01:50.630708+0300  INFO  Бот запущен
2024-10-14T21:02:41.915658+0300  INFO  Бот запущен
2024-10-14T21:02:41.915658+0300  INFO  Бот запущен
2024-10-14T21:03:28.269711+0300  INFO  Бот запущен
2024-10-14T21:03:28.269711+0300  INFO  Бот запущен
2024-10-14T21:04:05.872647+0300  INFO  Бот запущен
2024-10-14T21:04:05.872647+0300  INFO  Бот запущен
2024-10-14T21:05:23.005681+0300  INFO  Бот запущен
2024-10-14T21:05:23.005681+0300  INFO  Бот запущен
2024-10-14T21:06:49.618704+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:06:49.618704+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:06:49.618704+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:06:49.618704+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:06:49.618704+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:06:49.986655+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:06:49.986655+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:06:49.986655+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:06:49.986655+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:06:49.986655+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.621276+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:07:38.776337+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:44:47.596602+0300  INFO  Бот запущен
2024-10-14T21:44:47.596602+0300  INFO  Бот запущен
2024-10-14T21:44:55.807833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:44:55.807833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:44:55.807833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:44:55.807833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:44:55.807833+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:44:56.121509+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:44:56.121509+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:44:56.121509+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:44:56.121509+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:44:56.121509+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:55:34.159053+0300  INFO  Бот запущен
2024-10-14T21:55:34.159053+0300  INFO  Бот запущен
2024-10-14T21:56:23.160218+0300  INFO  Бот запущен
2024-10-14T21:56:23.160218+0300  INFO  Бот запущен
2024-10-14T21:57:18.472406+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:18.472406+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:18.472406+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:18.472406+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:18.472406+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:19.061715+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:19.061715+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:19.061715+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:19.061715+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:19.061715+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:25.343090+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:26.014516+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.428539+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T21:57:33.570038+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:25.978945+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:00:26.243583+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:06:06.540099+0300  INFO  Бот запущен
2024-10-14T22:06:06.540099+0300  INFO  Бот запущен
2024-10-14T22:06:49.123543+0300  INFO  Бот запущен
2024-10-14T22:06:49.123543+0300  INFO  Бот запущен
2024-10-14T22:07:06.570731+0300  INFO  Бот запущен
2024-10-14T22:07:06.570731+0300  INFO  Бот запущен
2024-10-14T22:07:51.711659+0300  INFO  Бот запущен
2024-10-14T22:07:51.711659+0300  INFO  Бот запущен
2024-10-14T22:08:40.696433+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:08:40.696433+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:08:40.696433+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:08:40.696433+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:08:40.696433+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:08:41.062163+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:08:41.062163+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:08:41.062163+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:08:41.062163+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:08:41.062163+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:45.791682+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:11:46.145097+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:15:50.787994+0300  INFO  Бот запущен
2024-10-14T22:15:50.787994+0300  INFO  Бот запущен
2024-10-14T22:16:57.317559+0300  INFO  Бот запущен
2024-10-14T22:16:57.317559+0300  INFO  Бот запущен
2024-10-14T22:18:06.051442+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:06.051442+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:06.051442+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:06.051442+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:06.051442+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:06.545359+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:06.545359+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:06.545359+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:06.545359+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:06.545359+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.755613+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:18:31.999389+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:20:16.332048+0300  INFO  Бот запущен
2024-10-14T22:20:16.332048+0300  INFO  Бот запущен
2024-10-14T22:24:57.062757+0300  INFO  Бот запущен
2024-10-14T22:24:57.062757+0300  INFO  Бот запущен
2024-10-14T22:27:13.143484+0300  INFO  Бот запущен
2024-10-14T22:27:13.143484+0300  INFO  Бот запущен
2024-10-14T22:27:43.001579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:27:43.001579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:27:43.001579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:27:43.001579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:27:43.001579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:27:43.421153+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:27:43.421153+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:27:43.421153+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:27:43.421153+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:27:43.421153+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.731023+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:07.991440+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.562579+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:24.687416+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.232548+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:28:37.401341+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.296274+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:20.438501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.513271+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:29:36.670770+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:30:03.806990+0300  INFO  Бот запущен
2024-10-14T22:30:03.806990+0300  INFO  Бот запущен
2024-10-14T22:30:56.834700+0300  INFO  Бот запущен
2024-10-14T22:30:56.834700+0300  INFO  Бот запущен
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:05.780243+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:06.259141+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.212851+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:33:39.385407+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:34:04.990652+0300  INFO  Бот запущен
2024-10-14T22:34:04.990652+0300  INFO  Бот запущен
2024-10-14T22:37:25.836094+0300  INFO  Бот запущен
2024-10-14T22:37:25.836094+0300  INFO  Бот запущен
2024-10-14T22:37:35.791559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:37:35.791559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:37:35.791559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:37:35.791559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:37:35.791559+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-14T22:37:36.098439+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:37:36.098439+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:37:36.098439+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:37:36.098439+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:37:36.098439+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:38:34.271405+0300  INFO  Бот запущен
2024-10-14T22:38:34.271405+0300  INFO  Бот запущен
2024-10-14T22:43:47.541815+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:43:47.541815+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:43:47.541815+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:43:47.541815+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:43:47.541815+0300  INFO  Ответ GPT gpt-4o получен для пользователя 857805093
2024-10-14T22:43:47.966352+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:43:47.966352+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:43:47.966352+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:43:47.966352+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T22:43:47.966352+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-14T23:05:12.312208+0300  INFO  Бот запущен
2024-10-14T23:05:12.312208+0300  INFO  Бот запущен
2024-10-14T23:10:08.022408+0300  INFO  Бот запущен
2024-10-14T23:10:08.022408+0300  INFO  Бот запущен
2024-10-14T23:10:32.817373+0300  INFO  Бот запущен
2024-10-14T23:10:32.817373+0300  INFO  Бот запущен
