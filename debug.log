2024-10-09T18:19:51.771305+0300  INFO  Бот запущен
2024-10-11T00:41:37.763615+0300  INFO  Бот запущен
2024-10-11T00:41:37.763615+0300  INFO  Бот запущен
2024-10-11T00:44:13.789125+0300  INFO  Бот запущен
2024-10-11T00:44:13.789125+0300  INFO  Бот запущен
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:44:22.658618+0300  ERROR  Пользователь: 857805093. Ошибка при работе с redis: Error 111 connecting to localhost:6379. Connection refused.
2024-10-11T00:46:28.668346+0300  INFO  Бот запущен
2024-10-11T00:46:28.668346+0300  INFO  Бот запущен
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:38.793510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:46:41.724152+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:18.784133+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:19.270249+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:47:54.687307+0300  INFO  Бот запущен
2024-10-11T00:47:54.687307+0300  INFO  Бот запущен
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:09.625058+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:10.034881+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.596297+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:48:30.859098+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:14.612589+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:49:15.624668+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.921950+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:21.980124+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.535873+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T00:50:50.614855+0300  INFO  Ответ gpt получен и отправлен пользователю: 2050793273
2024-10-11T13:41:47.826766+0300  INFO  Бот запущен
2024-10-11T13:41:47.826766+0300  INFO  Бот запущен
2024-10-11T13:42:39.137180+0300  INFO  Бот запущен
2024-10-11T13:42:39.137180+0300  INFO  Бот запущен
2024-10-11T13:44:47.636492+0300  INFO  Бот запущен
2024-10-11T13:44:47.636492+0300  INFO  Бот запущен
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.968630+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:45:11.969765+0300  ERROR  Ошибка при генерации ответа gpt: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T13:51:33.351399+0300  INFO  Бот запущен
2024-10-11T13:51:33.351399+0300  INFO  Бот запущен
2024-10-11T13:56:18.498395+0300  INFO  Бот запущен
2024-10-11T13:56:18.498395+0300  INFO  Бот запущен
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.479749+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.482228+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (45028), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x10c58b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10d74ac00>
                     └ <openai.AsyncOpenAI object at 0x10d61c650>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x10d61c650>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d71cce0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10c3718a0>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10c371940>
                 └ <openai.AsyncOpenAI object at 0x10d61c650>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10c366980>
          └ <openai.AsyncOpenAI object at 0x10d61c650>

openai.NotFoundError: <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>nginx</center>
</body>
</html>


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10ba9cf40>
    │       └ <function run at 0x104da3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10cf1e340>
           │      └ <function Runner.run at 0x104e254e0>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e1afc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10c5b57f0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e1af20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e24d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d62020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10f921c00>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,)}
                     │    │           │    └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10cf4ac60>
                     │    └ <function Dispatcher.feed_update at 0x10b9f3c40>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf64290>
                     └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10cf643b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10cf64470>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10b6065c0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714760, message=Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10cf5da80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10cf4af60'>>, Update(update_id=257714760, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10b9f3240>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4ac9a0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10cf4b0e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Dispatcher '0x10cf4af60'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10b9f3240>
                     └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10d4aca40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10b9f27a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10b9f32e0>
                 └ <Router '0x10ba8a7e0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10b9f28e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10ba8a690>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10cf4af60'>, 'bots': (<aiogram.client.bot.Bot object at 0x10cf4ac60>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10d4acd60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10cf47a60>, Message(message_id=2225, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x10cf4ac60>, 'state': <aiogram.fsm.context.FSMContext object at 0x10cf66960>}
                 │     └ (Message(message_id=2225, date=datetime.datetime(2024, 10, 11, 10, 56, 30, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10cf479c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 126, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'gpt-4o-mini'
                     │   └ 'Напиши телеграмм бота на. с++'
                     └ <function gpt at 0x10c7d8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T13:58:02.552493+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T14:01:27.878060+0300  INFO  Бот запущен
2024-10-11T14:01:27.878060+0300  INFO  Бот запущен
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:35.705608+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:36.612036+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.483634+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:01:54.740237+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:52.790461+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:02:53.052692+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:35.670018+0300  INFO  Бот запущен
2024-10-11T14:04:35.670018+0300  INFO  Бот запущен
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:43.386506+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:04:44.067391+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.277795+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:05:04.730370+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.303909+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:07:13.720912+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:47.705219+0300  INFO  Бот запущен
2024-10-11T14:10:47.705219+0300  INFO  Бот запущен
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:56.967121+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:10:57.415530+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.456510+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:12.719327+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.323561+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:11:27.626208+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:13:11.896596+0300  INFO  Бот запущен
2024-10-11T14:13:11.896596+0300  INFO  Бот запущен
2024-10-11T14:13:25.477238+0300  INFO  Бот запущен
2024-10-11T14:13:25.477238+0300  INFO  Бот запущен
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.808923+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:13:33.920175+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '>' is reserved and must be escaped with the preceding '\'
2024-10-11T14:15:37.958500+0300  INFO  Бот запущен
2024-10-11T14:15:37.958500+0300  INFO  Бот запущен
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.134490+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:15:48.135688+0300  ERROR  Ошибка при отправке сообщения: module 'aiogram.utils.markdown' has no attribute 'markdown_decorating'
2024-10-11T14:16:21.049120+0300  INFO  Бот запущен
2024-10-11T14:16:21.049120+0300  INFO  Бот запущен
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.320498+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:27.855292+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.270482+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:16:44.635372+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:50.604441+0300  INFO  Бот запущен
2024-10-11T14:17:50.604441+0300  INFO  Бот запущен
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:57.705493+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:17:58.219174+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.174557+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:18:13.419009+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:21:48.915453+0300  INFO  Бот запущен
2024-10-11T14:21:48.915453+0300  INFO  Бот запущен
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.116840+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:22:09.823985+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:02.359407+0300  INFO  Бот запущен
2024-10-11T14:24:02.359407+0300  INFO  Бот запущен
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:20.908939+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:24:21.419449+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:25:56.031464+0300  INFO  Бот запущен
2024-10-11T14:25:56.031464+0300  INFO  Бот запущен
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:10.275019+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:14.550196+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:26:47.347178+0300  INFO  Бот запущен
2024-10-11T14:26:47.347178+0300  INFO  Бот запущен
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:04.021249+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:27:05.998730+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:37:10.314063+0300  INFO  Бот запущен
2024-10-11T14:37:10.314063+0300  INFO  Бот запущен
2024-10-11T14:37:10.329787+0300  ERROR  An error has been caught in function '_run', process 'MainProcess' (45949), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 29, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1029b23e0>
    │       └ <function run at 0x10301fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107bbe340>
           │      └ <function Runner.run at 0x10309d4e0>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103092fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103092f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10309cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102fda020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

> File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 18, in main
    bot = Bot(token=os.getenv("BOT_TOKEN"),
          │         │  └ <function getenv at 0x10290a660>
          │         └ <module 'os' (frozen)>
          └ <class 'aiogram.client.bot.Bot'>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/client/bot.py", line 304, in __init__
    raise TypeError(

TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN_V2: 'MarkdownV2'>)` argument instead.
2024-10-11T14:37:10.329787+0300  ERROR  An error has been caught in function '_run', process 'MainProcess' (45949), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 29, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1029b23e0>
    │       └ <function run at 0x10301fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107bbe340>
           │      └ <function Runner.run at 0x10309d4e0>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103092fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103092f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10309cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102fda020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

> File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 18, in main
    bot = Bot(token=os.getenv("BOT_TOKEN"),
          │         │  └ <function getenv at 0x10290a660>
          │         └ <module 'os' (frozen)>
          └ <class 'aiogram.client.bot.Bot'>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/client/bot.py", line 304, in __init__
    raise TypeError(

TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN_V2: 'MarkdownV2'>)` argument instead.
2024-10-11T14:37:10.329787+0300  ERROR  An error has been caught in function '_run', process 'MainProcess' (45949), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 29, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1029b23e0>
    │       └ <function run at 0x10301fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107bbe340>
           │      └ <function Runner.run at 0x10309d4e0>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103092fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1077f6900>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103092f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10309cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102fda020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

> File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x1074354e0>()>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 18, in main
    bot = Bot(token=os.getenv("BOT_TOKEN"),
          │         │  └ <function getenv at 0x10290a660>
          │         └ <module 'os' (frozen)>
          └ <class 'aiogram.client.bot.Bot'>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/client/bot.py", line 304, in __init__
    raise TypeError(

TypeError: Passing `parse_mode`, `disable_web_page_preview` or `protect_content` to Bot initializer is not supported anymore. These arguments have been removed in 3.7.0 version. Use `default=DefaultBotProperties(parse_mode=<ParseMode.MARKDOWN_V2: 'MarkdownV2'>)` argument instead.
2024-10-11T14:41:53.049470+0300  INFO  Бот запущен
2024-10-11T14:41:53.049470+0300  INFO  Бот запущен
2024-10-11T14:41:56.379753+0300  ERROR  Ошибка при вводе команды /start: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-11T14:41:56.379753+0300  ERROR  Ошибка при вводе команды /start: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-11T14:41:56.379753+0300  ERROR  Ошибка при вводе команды /start: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-11T14:48:07.915750+0300  INFO  Бот запущен
2024-10-11T14:48:07.915750+0300  INFO  Бот запущен
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:16.924086+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:17.448037+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:31.855199+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:48:32.201172+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:45.982997+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T14:49:47.457948+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-11T15:23:00.633860+0300  INFO  Бот запущен
2024-10-11T15:23:00.633860+0300  INFO  Бот запущен
2024-10-11T15:23:54.017391+0300  INFO  Бот запущен
2024-10-11T15:23:54.017391+0300  INFO  Бот запущен
2024-10-11T15:24:11.126529+0300  INFO  Бот запущен
2024-10-11T15:24:11.126529+0300  INFO  Бот запущен
2024-10-11T15:26:52.528612+0300  INFO  Бот запущен
2024-10-11T15:26:52.528612+0300  INFO  Бот запущен
2024-10-11T15:27:33.026702+0300  INFO  Бот запущен
2024-10-11T15:27:33.026702+0300  INFO  Бот запущен
2024-10-11T15:27:56.228155+0300  INFO  Бот запущен
2024-10-11T15:27:56.228155+0300  INFO  Бот запущен
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.426853+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.428974+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47251), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x109e8b1a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x10a4fccb0>
                     └ <openai.AsyncOpenAI object at 0x109da3cb0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109da3cb0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10d818a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x109c718a0>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x109c71940>
                 └ <openai.AsyncOpenAI object at 0x109da3cb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x109c66980>
          └ <openai.AsyncOpenAI object at 0x109da3cb0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1027fe3e0>
    │       └ <function run at 0x102e67c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10a4b2440>
           │      └ <function Runner.run at 0x102ee94e0>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102edefc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109edffb0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102edef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102ee8d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102e26020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10d921ea0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,)}
                     │    │           │    └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x10a4e2f00>
                     │    └ <function Dispatcher.feed_update at 0x1093efc40>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4fc590>
                     └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x10a4fc6b0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x10a4fc770>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10a4f5b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714818, message=Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10aab09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x10a440920'>>, Update(update_id=257714818, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1093ef240>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10a4e3200>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Dispatcher '0x10a440920'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1093ef240>
                     └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10aab0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1093ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1093ef2e0>
                 └ <Router '0x10a36a3f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1093ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10947ed50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x10a440920'>, 'bots': (<aiogram.client.bot.Bot object at 0x10a4e2f00>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10a4f7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x10a4dfa60>, Message(message_id=2365, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x10a4fe420>, 'bot': <aiogram.client.bot.Bot object at 0x10a4e2f00>}
                 │     └ (Message(message_id=2365, date=datetime.datetime(2024, 10, 11, 12, 28, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x10a4df9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    text = await gpt(user_input, model, telegram_id)
                 │   │           │      └ 857805093
                 │   │           └ 'o1-mini'
                 │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                 └ <function gpt at 0x10a0d4c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:28:24.478247+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:29:55.757134+0300  INFO  Бот запущен
2024-10-11T15:29:55.757134+0300  INFO  Бот запущен
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.407985+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.409509+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47288), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079b31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1077ca9c0>
                     └ <openai.AsyncOpenAI object at 0x107fd0a40>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x107fd0a40>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x108a18e00>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077958a0>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x107795940>
                 └ <openai.AsyncOpenAI object at 0x107fd0a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10778a980>
          └ <openai.AsyncOpenAI object at 0x107fd0a40>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102d7e3e0>
    │       └ <function run at 0x1033e7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107f82440>
           │      └ <function Runner.run at 0x1034694e0>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10345efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10796acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10345ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103468d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033a6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x108b1e260>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,)}
                     │    │           │    └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fb6fc0>
                     │    └ <function Dispatcher.feed_update at 0x1070ffc40>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fd0140>
                     └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x107fd0260>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x107fd0320>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107fc5a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714821, message=Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1086b09a0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107a04410'>>, Update(update_id=257714821, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1070ff240>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0a40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fb6d50>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Dispatcher '0x107a04410'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1070ff240>
                     └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1086b0ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1070fe7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1070ff2e0>
                 └ <Router '0x1076b1790'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1070fe8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10718edb0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107a04410'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fb6fc0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107fc7ba0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fafa60>, Message(message_id=2372, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fb6fc0>, 'state': <aiogram.fsm.context.FSMContext object at 0x108721340>}
                 │     └ (Message(message_id=2372, date=datetime.datetime(2024, 10, 11, 12, 30, 10, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107faf9c0>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 128, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Добрый день, возникла ошибка. Когда ты пытаешься отредактировать текст в markdown: \n python\nresponse = markdown.text(markd...
                     └ <function gpt at 0x107ba8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:30:14.457698+0300  ERROR  Ошибка при отправке сообщения: object of type 'NoneType' has no len()
2024-10-11T15:34:34.345280+0300  INFO  Бот запущен
2024-10-11T15:34:34.345280+0300  INFO  Бот запущен
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.224207+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.225919+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47407), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1079e31a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109053350>
                     └ <openai.AsyncOpenAI object at 0x1076a96d0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1412, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1076a96d0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x109010d10>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1816, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1077c58a0>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1510, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1077c5940>
                 └ <openai.AsyncOpenAI object at 0x1076a96d0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1611, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1077be980>
          └ <openai.AsyncOpenAI object at 0x1076a96d0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x102dae3e0>
    │       └ <function run at 0x103417c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x107fb2440>
           │      └ <function Runner.run at 0x1034994e0>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10348efc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1078beed0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10348ef20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103498d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1033d6020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10921df90>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,)}
                     │    │           │    └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x107fe7320>
                     │    └ <function Dispatcher.feed_update at 0x10712fc40>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1080004d0>
                     └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1080005f0>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1080006b0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x107ff9b20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714824, message=Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x108380a40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x107fe6ea0'>>, Update(update_id=257714824, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x10712f240>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380ae0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x107fe7080>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Dispatcher '0x107fe6ea0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x10712f240>
                     └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x108380b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x10712e7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x10712f2e0>
                 └ <Router '0x1071a2ba0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x10712e8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1071c2a20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x107fe6ea0'>, 'bots': (<aiogram.client.bot.Bot object at 0x107fe7320>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x107ffbc40>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x107fdfb00>, Message(message_id=2379, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x107fe7320>, 'state': <aiogram.fsm.context.FSMContext object at 0x1084788f0>}
                 │     └ (Message(message_id=2379, date=datetime.datetime(2024, 10, 11, 12, 34, 49, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x107fdfa60>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Напиши калькулятор на C++'
                     └ <function gpt at 0x107bd8c20>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:34:51.273333+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:40.555603+0300  INFO  Бот запущен
2024-10-11T15:39:40.555603+0300  INFO  Бот запущен
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.515035+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.516238+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47577), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x106cb98a0>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x106c87e00>
                     └ <openai.AsyncOpenAI object at 0x106ca18b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x106ca18b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x110b94ef0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1069bbba0>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1069bbc40>
                 └ <openai.AsyncOpenAI object at 0x106ca18b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1069b8d60>
          └ <openai.AsyncOpenAI object at 0x106ca18b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-mini` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x106194ea0>
    │       └ <function run at 0x10122fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x1103db140>
           │      └ <function Runner.run at 0x1012b14e0>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1012a6fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1062b0710>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1012a6f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1012b0d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011ee020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x110d6de70>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,)}
                     │    │           │    └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1104335f0>
                     │    └ <function Dispatcher.feed_update at 0x1060efc40>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x110448a10>
                     └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x110448b30>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x110448bf0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x110441ee0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714827, message=Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x1104a0ae0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x106938ce0'>>, Update(update_id=257714827, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1060ef240>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0b80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1068e8f20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Dispatcher '0x106938ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1060ef240>
                     └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x1104a0c20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1060ee7a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1060ef2e0>
                 └ <Router '0x106182a50'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1060ee8e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x106182a80>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x106938ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x1104335f0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x110443ec0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x110423ec0>, Message(message_id=2385, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x110a68a10>, 'bot': <aiogram.client.bot.Bot object at 0x1104335f0>}
                 │     └ (Message(message_id=2385, date=datetime.datetime(2024, 10, 11, 12, 39, 47, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x110423e20>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-mini'
                     │   └ 'Привет!'
                     └ <function gpt at 0x106dbd620>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:39:49.551021+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:40:52.109798+0300  INFO  Бот запущен
2024-10-11T15:40:52.109798+0300  INFO  Бот запущен
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.030002+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.032774+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47618), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x1095d7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x109c029c0>
                     └ <openai.AsyncOpenAI object at 0x109319040>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x109319040>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10a1aa990>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x1093ba020>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x1093ba0c0>
                 └ <openai.AsyncOpenAI object at 0x109319040>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x1093af1a0>
          └ <openai.AsyncOpenAI object at 0x109319040>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x1049963e0>
    │       └ <function run at 0x104fffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x109bb2540>
           │      └ <function Runner.run at 0x1050814e0>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105076fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x109ad4920>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105076f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105080d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104fbe020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10a26b6d0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,)}
                     │    │           │    └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x109c011c0>
                     │    └ <function Dispatcher.feed_update at 0x108d17c40>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c022d0>
                     └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x109c02390>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x109c02450>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function TelegramEventObserver.trigger at 0x109f3c5e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714830, message=Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC))...
                 └ <function CallableObject.call at 0x109f3f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x109380ce0'>>, Update(update_id=257714830, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x108d17240>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f380>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x109c01100>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Dispatcher '0x109380ce0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x108d17240>
                     └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x109f3f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x108d167a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x108d172e0>
                 └ <Router '0x10941a300'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                     │        └ <function TelegramEventObserver.trigger at 0x108d168e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x108af5730>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x109380ce0'>, 'bots': (<aiogram.client.bot.Bot object at 0x109c011c0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='priv...
                 └ <function CallableObject.call at 0x109f3e700>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x109bf25c0>, Message(message_id=2391, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x109f48aa0>, 'bot': <aiogram.client.bot.Bot object at 0x109c011c0>}
                 │     └ (Message(message_id=2391, date=datetime.datetime(2024, 10, 11, 12, 41, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='pri...
                 └ <function process_generation at 0x109bf2520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'Привет!'
                     └ <function gpt at 0x1097cb6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:41:02.093361+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:45:33.575733+0300  INFO  Бот запущен
2024-10-11T15:45:33.575733+0300  INFO  Бот запущен
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.206289+0300  ERROR  Ошибка при обработке запроса для пользователя 857805093: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.208966+0300  ERROR  An error has been caught in function 'process_generation', process 'MainProcess' (47739), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 45, in gpt
    response = await client.chat.completions.create(
                     │      │    │           └ <function AsyncCompletions.create at 0x105aa7f60>
                     │      │    └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
                     │      └ <openai.resources.chat.chat.AsyncChat object at 0x1057ec2c0>
                     └ <openai.AsyncOpenAI object at 0x1064189b0>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1490, in create
    return await self._post(
                 │    └ <bound method AsyncAPIClient.post of <openai.AsyncOpenAI object at 0x1064189b0>>
                 └ <openai.resources.chat.completions.AsyncCompletions object at 0x10668ac60>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1838, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
                 │    │       │        │            │                  └ openai.AsyncStream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
                 │    │       │        │            └ False
                 │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
                 │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
                 │    └ <function AsyncAPIClient.request at 0x10588e020>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1532, in request
    return await self._request(
                 │    └ <function AsyncAPIClient._request at 0x10588e0c0>
                 └ <openai.AsyncOpenAI object at 0x1064189b0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/openai/_base_client.py", line 1633, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x10587f1a0>
          └ <openai.AsyncOpenAI object at 0x1064189b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'The model `o1-preview` does not exist or you do not have access to it.', 'type': 'invalid_request_error', 'param': None, 'code': 'model_not_found'}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 27, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x10528cea0>
    │       └ <function run at 0x1014cfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyn...

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x10607e540>
           │      └ <function Runner.run at 0x1015514e0>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at /Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-Xdx...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101546fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10596acc0>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101546f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101550d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1986, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10148e020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/opt/homebrew/Cellar/python@3.12/3.12.7/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x10692ada0>()>

  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,)}
                     │    │           │    └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                     │    │           └ <aiogram.client.bot.Bot object at 0x1060d0da0>
                     │    └ <function Dispatcher.feed_update at 0x1051e7c40>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d23f0>
                     └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x1060d2510>, functools.partia...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x1060d25d0>, <function TelegramEventObserver.trigge...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 42, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │       └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function TelegramEventObserver.trigger at 0x10640f2e0>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Update(update_id=257714833, message=Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(U...
                 └ <function CallableObject.call at 0x10640f380>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1060d1130'>>, Update(update_id=257714833, message...
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │    │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x1051e7240>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f420>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x1060d0e30>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Dispatcher '0x1060d1130'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │      │                           │                  └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x1051e7240>
                     └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │        │                     │               └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x10640f4c0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x1051e67a0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 141, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x1051e72e0>
                 └ <Router '0x1051dd4f0'>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                     │        │       └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                     │        └ <function TelegramEventObserver.trigger at 0x1051e68e0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x10527ad20>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1060d1130'>, 'bots': (<aiogram.client.bot.Bot object at 0x1060d0da0>,), 'bot': <aiogram.client....
                 │             └ Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type='...
                 └ <function CallableObject.call at 0x10640f600>
  File "/Users/aleksandrvolzanin/Library/Caches/pypoetry/virtualenvs/chat-gpt-XdxLKf6H-py3.12/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_generation at 0x1060be5c0>, Message(message_id=2397, date=datetime.datetime(2024, 10, 11,...

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/call_count_gpt.py", line 71, in wrapper
    return await func(*args, **kwargs)
                 │     │       └ {'state': <aiogram.fsm.context.FSMContext object at 0x106532360>, 'bot': <aiogram.client.bot.Bot object at 0x1060d0da0>}
                 │     └ (Message(message_id=2397, date=datetime.datetime(2024, 10, 11, 12, 46, 14, tzinfo=TzInfo(UTC)), chat=Chat(id=857805093, type=...
                 └ <function process_generation at 0x1060be520>

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 143, in process_generation
    response = await gpt(user_input, model, telegram_id)
                     │   │           │      └ 857805093
                     │   │           └ 'o1-preview'
                     │   └ 'привет!'
                     └ <function gpt at 0x105c9f6a0>

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/generators.py", line 66, in gpt
    raise Exception("Произошла ошибка при обработке запроса.")

Exception: Произошла ошибка при обработке запроса.
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:46:16.254971+0300  ERROR  Ошибка при генерации ответа gpt: expected string or bytes-like object, got 'NoneType'
2024-10-11T15:55:49.527525+0300  INFO  Бот запущен
2024-10-11T15:55:49.527525+0300  INFO  Бот запущен
2024-10-11T15:57:43.317451+0300  INFO  Бот запущен
2024-10-11T15:57:43.317451+0300  INFO  Бот запущен
2024-10-12T01:24:33.651258+0300  INFO  Бот запущен
2024-10-12T01:24:33.651258+0300  INFO  Бот запущен
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.889673+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T01:24:53.968850+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:26:38.245319+0300  INFO  Бот запущен
2024-10-12T04:26:38.245319+0300  INFO  Бот запущен
2024-10-12T04:27:29.923567+0300  INFO  Бот запущен
2024-10-12T04:27:29.923567+0300  INFO  Бот запущен
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:40.647877+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:27:41.005938+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:01.732752+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:28:02.037027+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:40:41.419433+0300  INFO  Бот запущен
2024-10-12T04:40:41.419433+0300  INFO  Бот запущен
2024-10-12T04:42:47.763040+0300  INFO  Бот запущен
2024-10-12T04:42:47.763040+0300  INFO  Бот запущен
2024-10-12T04:43:15.395828+0300  INFO  Бот запущен
2024-10-12T04:43:15.395828+0300  INFO  Бот запущен
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:01.946276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:45:02.022588+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T04:46:20.578655+0300  INFO  Бот запущен
2024-10-12T04:46:20.578655+0300  INFO  Бот запущен
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:30.723386+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:46:31.089396+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.535815+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:48:21.794321+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:42.460478+0300  INFO  Бот запущен
2024-10-12T04:54:42.460478+0300  INFO  Бот запущен
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.440126+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T04:54:54.819264+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:36.177883+0300  INFO  Бот запущен
2024-10-12T05:04:36.177883+0300  INFO  Бот запущен
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:51.852620+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:04:52.254930+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:06:31.295600+0300  INFO  Бот запущен
2024-10-12T05:06:31.295600+0300  INFO  Бот запущен
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.762451+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:06:43.764130+0300  ERROR  Ошибка при генерации ответа gpt: 'MarkdownDecoration' object is not callable
2024-10-12T05:07:09.053254+0300  INFO  Бот запущен
2024-10-12T05:07:09.053254+0300  INFO  Бот запущен
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:25.646107+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T05:07:26.000501+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:36:44.859734+0300  INFO  Бот запущен
2024-10-12T23:36:44.859734+0300  INFO  Бот запущен
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.527276+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:37:32.599435+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-12T23:42:46.001754+0300  INFO  Бот запущен
2024-10-12T23:42:46.001754+0300  INFO  Бот запущен
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:53.102820+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:42:54.124887+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.473171+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:12.553528+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '#' is reserved and must be escaped with the preceding '\'
2024-10-12T23:43:27.509616+0300  INFO  Бот запущен
2024-10-12T23:43:27.509616+0300  INFO  Бот запущен
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:53.823315+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-12T23:43:54.213917+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:09:16.798199+0300  INFO  Бот запущен
2024-10-13T00:09:16.798199+0300  INFO  Бот запущен
2024-10-13T00:11:05.195076+0300  INFO  Бот запущен
2024-10-13T00:11:05.195076+0300  INFO  Бот запущен
2024-10-13T00:12:29.039578+0300  INFO  Бот запущен
2024-10-13T00:12:29.039578+0300  INFO  Бот запущен
2024-10-13T00:14:03.325333+0300  INFO  Бот запущен
2024-10-13T00:14:03.325333+0300  INFO  Бот запущен
2024-10-13T00:14:23.898268+0300  INFO  Бот запущен
2024-10-13T00:14:23.898268+0300  INFO  Бот запущен
2024-10-13T00:17:07.840941+0300  INFO  Бот запущен
2024-10-13T00:17:07.840941+0300  INFO  Бот запущен
2024-10-13T00:17:47.631680+0300  INFO  Бот запущен
2024-10-13T00:17:47.631680+0300  INFO  Бот запущен
2024-10-13T00:19:32.486472+0300  INFO  Бот запущен
2024-10-13T00:19:32.486472+0300  INFO  Бот запущен
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:40.388500+0300  ERROR  Ошибка с подсчётом количества вызовов: Bot.send_animation() missing 1 required positional argument: 'self'
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:41.930987+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:19:42.499000+0300  INFO  Ответ gpt получен и отправлен пользователю: 857805093
2024-10-13T00:22:00.929352+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51406), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 116, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1096f4720>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:22:00.929352+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51406), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 116, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1096f4720>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:31:38.244624+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51594), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 119, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1077cc680>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:31:38.244624+0300  ERROR  An error has been caught in function '<module>', process 'MainProcess' (51594), thread 'MainThread' (7904336960):
Traceback (most recent call last):

  File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/run.py", line 8, in <module>
    from app.handlers import router

  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed

> File "/Users/aleksandrvolzanin/pet_project/CHATGPT_BOT/app/handlers.py", line 119, in <module>
    @count_calls(bot=Bot)
     │               └ <class 'aiogram.client.bot.Bot'>
     └ <function count_calls at 0x1077cc680>

TypeError: count_calls() got an unexpected keyword argument 'bot'
2024-10-13T00:31:59.468931+0300  INFO  Бот запущен
2024-10-13T00:31:59.468931+0300  INFO  Бот запущен
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:32:03.910236+0300  ERROR  Ошибка с подсчётом количества вызовов: '>' not supported between instances of 'int' and 'type'
2024-10-13T00:33:40.184619+0300  INFO  Бот запущен
2024-10-13T00:33:40.184619+0300  INFO  Бот запущен
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:57.971187+0300  INFO  Ответ GPT gpt-4o-mini получен для пользователя 857805093
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:33:58.048966+0300  ERROR  Ошибка при отправке сообщения: Telegram server says - Bad Request: can't parse entities: Character '!' is reserved and must be escaped with the preceding '\'
2024-10-13T00:35:03.339157+0300  INFO  Бот запущен
2024-10-13T00:36:11.118014+0300  INFO  Бот запущен
2024-10-13T00:39:44.791792+0300  INFO  Бот запущен
2024-10-13T00:40:04.258506+0300  INFO  Бот запущен
2024-10-13T00:47:31.481478+0300  INFO  Бот запущен
2024-10-13T00:47:47.375331+0300  INFO  Бот запущен
2024-10-13T00:48:26.206485+0300  INFO  Бот запущен
2024-10-13T00:50:22.775912+0300  INFO  Бот запущен
2024-10-13T00:51:31.360380+0300  INFO  Бот запущен
2024-10-13T00:52:41.535607+0300  INFO  Бот запущен
2024-10-13T00:53:18.685267+0300  INFO  Бот запущен
2024-10-13T00:53:35.082218+0300  INFO  Бот запущен
2024-10-13T00:54:17.287265+0300  INFO  Бот запущен
2024-10-13T00:54:45.431489+0300  INFO  Бот запущен
2024-10-13T00:55:58.069650+0300  INFO  Бот запущен
2024-10-13T00:56:47.504673+0300  INFO  Бот запущен
2024-10-13T00:59:17.386010+0300  INFO  Бот запущен
2024-10-13T01:00:30.724682+0300  INFO  Бот запущен
2024-10-13T01:00:56.033789+0300  INFO  Бот запущен
2024-10-13T01:01:05.125825+0300  INFO  Бот запущен
2024-10-13T01:01:15.118325+0300  INFO  Бот запущен
2024-10-13T01:01:26.324781+0300  INFO  Бот запущен
2024-10-13T01:01:38.568866+0300  INFO  Бот запущен
2024-10-13T01:02:00.110230+0300  INFO  Бот запущен
2024-10-13T01:02:19.140168+0300  INFO  Бот запущен
